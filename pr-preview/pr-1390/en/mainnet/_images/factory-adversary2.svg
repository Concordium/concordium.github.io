<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="660" height="636"><desc>actor%20User%0A%0Aparticipant%20Factory%0A%0AUser-%3E*Product%3Ainit_product%0Aactivate%20Product%0AProduct--%3EUser%3A%3C%3CProduct%3E%3E%0Adeactivate%20Product%0A%0A%0Aparticipant%20BadFactory%0Aactor%20Adversary%0A%0AAdversary-%3EBadFactory%3Asteal(Product)%0Aactivate%20BadFactory%0ABadFactory-%3EProduct%3Ainitialize%0Aactivate%20Product%0AProduct--%3EBadFactory%3A%3C%3Cfailure%3E%3E%0Adeactivate%20Product%0ABadFactory-%3EAdversary%3A%3C%3Cfailure%3E%3E%0Adeactivate%20BadFactory%0A%0AUser-%3EFactory%3Aproduce(Product)%0Aactivate%20Factory%0AFactory-%3EProduct%3Ainitialize%0Aactivate%20Product%0AProduct--%3EFactory%3A%3C%3Csuccess%3E%3E%0Adeactivate%20Product%0AFactory--%3EUser%3A%3C%3Csuccess%3E%3E%0Adeactivate%20Factory</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="660" height="636"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.66760165 87.9650697705 L 23.66760165 636.3378445515" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 189.3957454333333 87.9650697705 L 189.3957454333333 636.3378445515" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 341.29149086666666 167.5175098415 L 341.29149086666666 636.3378445515" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 476.1872363 87.9650697705 L 476.1872363 636.3378445515" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 619.9153800833333 87.9650697705 L 619.9153800833333 636.3378445515" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 32.978667531 18.867159811499988 A 9.311065881 9.311065881 0 1 1 32.97866287546745 18.857848747170827 M 23.66760165 28.17822569249999 L 23.66760165 48.10717371849999 M 11.906255274000003 35.36571514449999 L 35.428948026 35.36571514449999 M 23.66760165 48.10717371849999 L 11.906255274000003 66.72930548049999 M 23.66760165 48.10717371849999 L 35.428948026 66.72930548049999" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="8.167601650000002" y="83.06450878049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 147.1720498528333 43.8600208605 L 231.61944101383332 43.8600208605 L 231.61944101383332 87.9650697705 L 147.1720498528333 87.9650697705 L 147.1720498528333 43.8600208605 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="164.8957454333333" y="71.62986647049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Factory</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 420.9635407195 43.8600208605 L 531.4109318805 43.8600208605 L 531.4109318805 87.9650697705 L 420.9635407195 87.9650697705 L 420.9635407195 43.8600208605 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="438.6872363" y="71.62986647049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BadFactory</text></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 629.2264459643333 18.867159811499988 A 9.311065881 9.311065881 0 1 1 629.2264413088008 18.857848747170827 M 619.9153800833333 28.17822569249999 L 619.9153800833333 48.10717371849999 M 608.1540337073333 35.36571514449999 L 631.6767264593333 35.36571514449999 M 619.9153800833333 48.10717371849999 L 608.1540337073333 66.72930548049999 M 619.9153800833333 48.10717371849999 L 631.6767264593333 66.72930548049999" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.4153800833333" y="83.06450878049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Adversary</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 333.12388921666667 167.5175098415 L 349.45909251666666 167.5175098415 L 349.45909251666666 213.2560790815 L 333.12388921666667 213.2560790815 L 333.12388921666667 167.5175098415" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 468.01963465 258.9946483215 L 484.35483795 258.9946483215 L 484.35483795 396.2103560415 L 468.01963465 396.2103560415 L 468.01963465 258.9946483215" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 333.12388921666667 304.7332175615 L 349.45909251666666 304.7332175615 L 349.45909251666666 350.4717868015 L 333.12388921666667 350.4717868015 L 333.12388921666667 304.7332175615" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 181.2281437833333 441.9489252815 L 197.5633470833333 441.9489252815 L 197.5633470833333 579.1646330015 L 181.2281437833333 579.1646330015 L 181.2281437833333 441.9489252815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 333.12388921666667 487.6874945215 L 349.45909251666666 487.6874945215 L 349.45909251666666 533.4260637615 L 333.12388921666667 533.4260637615 L 333.12388921666667 487.6874945215" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 298.06779528616664 122.02396865099999 L 384.5151864471667 122.02396865099999 L 384.5151864471667 166.12901756099998 L 298.06779528616664 166.12901756099998 L 298.06779528616664 122.02396865099999 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="315.79149086666666" y="149.793814261" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Product</text></g><g><g><rect fill="white" stroke="none" x="120.91741797308332" y="122.840728816" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="123.36769846808332" y="137.542411786" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">init_product</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.66760165 144.076493106 L 284.6184779025 144.076493106" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(298.06779528616664,144.076493106) translate(-298.06779528616664,-144.076493106)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 284.45512586949997 137.27015839766665 L 298.06779528616664 144.076493106 L 284.45512586949997 150.88282781433333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="132.44546493833334" y="192.0203147915" width="91.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.89574543333333" y="206.72199776149998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;Product&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 333.12388921666667 213.2560790815 L 37.11691903366667 213.2560790815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(23.66760165,213.2560790815) translate(-23.66760165,-213.2560790815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 37.28027106666667 206.44974437316665 L 23.66760165 213.2560790815 L 37.28027106666667 220.06241378983333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="503.68482852166665" y="237.7588840315" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.13510901666666" y="252.46056700149998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">steal(Product)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 619.9153800833333 258.9946483215 L 497.80415533366664 258.9946483215" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(484.35483795,258.9946483215) translate(-484.35483795,-258.9946483215)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 497.96750736666667 252.18831361316666 L 484.35483795 258.9946483215 L 497.96750736666667 265.80098302983333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="380.7890830883333" y="283.4974532715" width="55.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.23936358333333" y="298.19913624149996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">initialize</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 468.01963465 304.7332175615 L 362.9084099003333 304.7332175615" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(349.45909251666666,304.7332175615) translate(-349.45909251666666,-304.7332175615)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 363.07176193333333 297.92688285316666 L 349.45909251666666 304.7332175615 L 363.07176193333333 311.53955226983334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="368.7890830883333" y="329.2360225115" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="371.23936358333333" y="343.93770548149996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;failure&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 349.45909251666666 350.4717868015 L 454.57031726633335 350.4717868015" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(468.01963465,350.4717868015) translate(-468.01963465,-350.4717868015)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 454.4069652333333 343.66545209316666 L 468.01963465 350.4717868015 L 454.4069652333333 357.27812150983334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="512.1848285216666" y="374.9745917515" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.6351090166667" y="389.67627472149996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;failure&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 484.35483795 396.2103560415 L 606.4660626996666 396.2103560415" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(619.9153800833333,396.2103560415) translate(-619.9153800833333,-396.2103560415)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 606.3027106666666 389.40402133316667 L 619.9153800833333 396.2103560415 L 606.3027106666666 403.01669074983334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="42.997592221666665" y="420.7131609915" width="118.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="45.447872716666666" y="435.41484396149997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">produce(Product)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.66760165 441.9489252815 L 167.77882639966663 441.9489252815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(181.2281437833333,441.9489252815) translate(-181.2281437833333,-441.9489252815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 167.61547436666663 435.1425905731667 L 181.2281437833333 441.9489252815 L 167.61547436666663 448.75525998983335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="237.393337655" y="466.4517302315" width="55.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="239.84361815" y="481.1534132015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">initialize</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 197.5633470833333 487.6874945215 L 319.674571833 487.6874945215" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(333.12388921666667,487.6874945215) translate(-333.12388921666667,-487.6874945215)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 319.5112198 480.8811598131667 L 333.12388921666667 487.6874945215 L 319.5112198 494.49382922983335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="216.893337655" y="512.1902994715" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="219.34361815" y="526.8919824415" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;success&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 333.12388921666667 533.4260637615 L 211.01266446699998 533.4260637615" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(197.5633470833333,533.4260637615) translate(-197.5633470833333,-533.4260637615)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 211.17601649999997 526.6197290531667 L 197.5633470833333 533.4260637615 L 211.17601649999997 540.2323984698334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="53.997592221666665" y="557.9288687115" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="56.447872716666666" y="572.6305516814999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;success&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 181.2281437833333 579.1646330015 L 37.11691903366667 579.1646330015" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(23.66760165,579.1646330015) translate(-23.66760165,-579.1646330015)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 37.28027106666667 572.3582982931666 L 23.66760165 579.1646330015 L 37.28027106666667 585.9709677098333 Z"/></g></g></g><g/><g/><g/><g/></g></svg>