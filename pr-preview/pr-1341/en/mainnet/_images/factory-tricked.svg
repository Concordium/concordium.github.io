<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="629" height="776"><desc>actor%20User%0A%0Aparticipant%20Factory%0A%0AUser-%3E*Product%3Ainit_product%0Aactivate%20Product%0AProduct--%3EUser%3A%3C%3CProduct%3E%3E%0Adeactivate%20Product%0A%0A%0Aparticipant%20BadFactory%0A%0Anote%20over%20User%3AAdversary%20tricks%20User%20into%5Cnsigning%20a%20bad%20transaction.%0AUser-%3EBadFactory%3Asteal(Product)%0Aactivate%20BadFactory%0ABadFactory-%3EProduct%3Ainitialize%0Aactivate%20Product%0Arbox%20over%20Product%3Ainvoker%20%3D%3D%20owner%0AProduct--%3EBadFactory%3A%3C%3Csuccess%3E%3E%0Adeactivate%20Product%0ABadFactory-%3EUser%3A%3C%3Csuccess%3E%3E%0Adeactivate%20BadFactory%0A%0AUser-%3EFactory%3Aproduce(Product)%0Aactivate%20Factory%0AFactory-%3EProduct%3Ainitialize%0Aactivate%20Product%0AProduct--%3EFactory%3A%3C%3Cfailure%3E%3E%0Adeactivate%20Product%0AFactory--%3EUser%3A%3C%3Cfailure%3E%3E%0Adeactivate%20Factory%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="629" height="776"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.03688627 87.9650697705 L 114.03688627 776.8205929314997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 279.7650300533333 87.9650697705 L 279.7650300533333 776.8205929314997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 414.66077548666664 167.5175098415 L 414.66077548666664 776.8205929314997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 566.5565209199999 87.9650697705 L 566.5565209199999 776.8205929314997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 123.347952151 18.867159811499988 A 9.311065881 9.311065881 0 1 1 123.34794749546744 18.857848747170827 M 114.03688627 28.17822569249999 L 114.03688627 48.10717371849999 M 102.27553989399999 35.36571514449999 L 125.798232646 35.36571514449999 M 114.03688627 48.10717371849999 L 102.27553989399999 66.72930548049999 M 114.03688627 48.10717371849999 L 125.798232646 66.72930548049999" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="98.53688627" y="83.06450878049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 237.54133447283328 43.8600208605 L 321.98872563383327 43.8600208605 L 321.98872563383327 87.9650697705 L 237.54133447283328 87.9650697705 L 237.54133447283328 43.8600208605 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="255.2650300533333" y="71.62986647049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Factory</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 511.3328253394999 43.8600208605 L 621.7802165004999 43.8600208605 L 621.7802165004999 87.9650697705 L 511.3328253394999 87.9650697705 L 511.3328253394999 43.8600208605 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="529.0565209199999" y="71.62986647049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BadFactory</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 406.49317383666664 167.5175098415 L 422.82837713666663 167.5175098415 L 422.82837713666663 213.2560790815 L 406.49317383666664 213.2560790815 L 406.49317383666664 167.5175098415" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 558.3889192699999 337.4036241615 L 574.72412257 337.4036241615 L 574.72412257 536.6931044214999 L 558.3889192699999 536.6931044214999 L 558.3889192699999 337.4036241615" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 406.49317383666664 383.1421934015 L 422.82837713666663 383.1421934015 L 422.82837713666663 490.9545351815 L 406.49317383666664 490.9545351815 L 406.49317383666664 383.1421934015" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 271.5974284033333 582.4316736614999 L 287.9326317033333 582.4316736614999 L 287.9326317033333 719.6473813814997 L 271.5974284033333 719.6473813814997 L 271.5974284033333 582.4316736614999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 406.49317383666664 628.1702429014998 L 422.82837713666663 628.1702429014998 L 422.82837713666663 673.9088121414998 L 406.49317383666664 673.9088121414998 L 406.49317383666664 628.1702429014998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 371.4370799061666 122.02396865099999 L 457.8844710671666 122.02396865099999 L 457.8844710671666 166.12901756099998 L 371.4370799061666 166.12901756099998 L 371.4370799061666 122.02396865099999 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="389.16077548666664" y="149.793814261" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Product</text></g><g><g><rect fill="white" stroke="none" x="202.7867025930833" y="122.840728816" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="205.2369830880833" y="137.542411786" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">init_product</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.03688627 144.076493106 L 357.98776252249996 144.076493106" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(371.4370799061666,144.076493106) translate(-371.4370799061666,-144.076493106)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 357.82441048949994 137.27015839766665 L 371.4370799061666 144.076493106 L 357.82441048949994 150.88282781433333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="214.31474955833338" y="192.0203147915" width="91.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="216.76503005333336" y="206.72199776149998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;Product&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 406.49317383666664 213.2560790815 L 127.48620365366666 213.2560790815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(114.03688627,213.2560790815) translate(-114.03688627,-213.2560790815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.64955568666666 206.44974437316665 L 114.03688627 213.2560790815 L 127.64955568666666 220.06241378983333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 237.75888403149997 L 205.20448792 237.75888403149997 L 219.90617089 252.46056700149998 L 219.90617089 291.6650549215 L 8.16760165 291.6650549215 L 8.16760165 237.75888403149997 M 205.20448792 237.75888403149997 L 205.20448792 252.46056700149998 L 219.90617089 252.46056700149998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="31.036886269999997" y="260.62816865149995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Adversary tricks User into</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="31.036886269999997" y="276.96337195149994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">signing a bad transaction.</text></g><g><g><rect fill="white" stroke="none" x="287.7626222749999" y="316.16785987149996" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="290.2129027699999" y="330.86954284149994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">steal(Product)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.03688627 337.4036241615 L 544.9396018863332 337.4036241615" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(558.3889192699999,337.4036241615) translate(-558.3889192699999,-337.4036241615)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 544.7762498533332 330.59728945316664 L 558.3889192699999 337.4036241615 L 544.7762498533332 344.2099588698333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="462.65836770833323" y="361.90642911149996" width="55.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="465.10864820333325" y="376.60811208149994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">initialize</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 558.3889192699999 383.1421934015 L 436.2776945203333 383.1421934015" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(422.82837713666663,383.1421934015) translate(-422.82837713666663,-383.1421934015)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 436.4410465533333 376.33585869316664 L 422.82837713666663 383.1421934015 L 436.4410465533333 389.9485281098333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 335.7914908666666 422.34668132149994 L 335.7914908666666 422.34668132149994 A 14.70168297 14.70168297 0 0 1 350.4931738366666 407.64499835149996 L 478.82837713666663 407.64499835149996 L 478.82837713666663 407.64499835149996 A 14.70168297 14.70168297 0 0 1 493.5300601066666 422.34668132149994 L 493.5300601066666 430.5142829715 L 493.5300601066666 430.5142829715 A 14.70168297 14.70168297 0 0 1 478.82837713666663 445.2159659415 L 350.4931738366666 445.2159659415 L 350.4931738366666 445.2159659415 A 14.70168297 14.70168297 0 0 1 335.7914908666666 430.5142829715 L 335.7914908666666 422.34668132149994" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="358.66077548666664" y="430.51428297149994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">invoker == owner</text></g><g><g><rect fill="white" stroke="none" x="442.15836770833323" y="469.71877089149996" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="444.60864820333325" y="484.42045386149994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;success&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 422.82837713666663 490.9545351815 L 544.9396018863332 490.9545351815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(558.3889192699999,490.9545351815) translate(-558.3889192699999,-490.9545351815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 544.7762498533332 484.14820047316664 L 558.3889192699999 490.9545351815 L 544.7762498533332 497.7608698898333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="287.7626222749999" y="515.4573401314999" width="96.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="290.2129027699999" y="530.1590231014999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;success&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 558.3889192699999 536.6931044214999 L 127.48620365366666 536.6931044214999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(114.03688627,536.6931044214999) translate(-114.03688627,-536.6931044214999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.64955568666666 529.8867697131666 L 114.03688627 536.6931044214999 L 127.64955568666666 543.4994391298333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="133.36687684166665" y="561.1959093714999" width="118.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="135.81715733666664" y="575.8975923414998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">produce(Product)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.03688627 582.4316736614999 L 258.14811101966666 582.4316736614999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(271.5974284033333,582.4316736614999) translate(-271.5974284033333,-582.4316736614999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.98475898666663 575.6253389531665 L 271.5974284033333 582.4316736614999 L 257.98475898666663 589.2380083698332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="319.26262227499996" y="606.9344786114998" width="55.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="321.71290276999997" y="621.6361615814998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">initialize</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 287.9326317033333 628.1702429014998 L 393.043856453 628.1702429014998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(406.49317383666664,628.1702429014998) translate(-406.49317383666664,-628.1702429014998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 392.88050441999997 621.3639081931665 L 406.49317383666664 628.1702429014998 L 392.88050441999997 634.9765776098332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="307.26262227499996" y="652.6730478514997" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="309.71290276999997" y="667.3747308214997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;failure&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 406.49317383666664 673.9088121414998 L 301.38194908699995 673.9088121414998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(287.9326317033333,673.9088121414998) translate(-287.9326317033333,-673.9088121414998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 301.54530112 667.1024774331664 L 287.9326317033333 673.9088121414998 L 301.54530112 680.7151468498331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="152.86687684166665" y="698.4116170914997" width="79.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="155.31715733666664" y="713.1133000614997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&lt;&lt;failure&gt;&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 271.5974284033333 719.6473813814997 L 127.48620365366666 719.6473813814997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(114.03688627,719.6473813814997) translate(-114.03688627,-719.6473813814997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.64955568666666 712.8410466731664 L 114.03688627 719.6473813814997 L 127.64955568666666 726.453716089833 Z"/></g></g></g><g/><g/><g/></g></svg>