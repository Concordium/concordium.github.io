


<!DOCTYPE html>


<html lang="en" data-content_root="../../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Testing the piggy bank smart contract &#8212; Concordium  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/style.css?v=87251df2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/tippy.css?v=6175c28d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=716d1818"></script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
    <script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
    <script defer="defer" src="../../../_static/tippy/smart-contracts-v0/tutorials/piggy-bank/testing.d8b8b683-f47c-44c6-af63-a6e23e5b8a05.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'smart-contracts-v0/tutorials/piggy-bank/testing';</script>
    <link rel="icon" href="../../../_static/concordium-logo-no-text.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Contract development guides" href="../../guides/contract-dev-guides.html" />
    <link rel="prev" title="Writing the piggy bank smart contract" href="writing.html" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" />


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item"><style>
.navbar-brand img {
    max-height: 200px;
    width: auto;
}
</style>

<div>
    <a href="https://developer.concordium.software/">
        <img class="logo" src="../../../_static/concordium-logo-dark.svg" />
    </a>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><style>
body {margin:0;}

.navbar-menu {
  position: relative;
  margin-left: 190px;
  background: none;
}

.navbar-light {
    background: #ededed!important;
    box-shadow: none;
}

.navbar-menu a {
  float: left;
  display: inline;
  text-align: center;
  color: var(--font-color);
  font-size: 15px;
}

/* Dropdown Button */
.dropbtn {
  background: none;
  color: black;
  font-size: 16px;
  font-weight: 600;
  padding-left: 20px;
  padding-right: 20px;
  border: none;
  font-family: inherit; /* Important for vertical align on mobile phones */
  margin: 0; /* Important for vertical align on mobile phones */
}

/* The dropdown container */
.dropdown {
    float: left;
  }

  /* Dropdown content (hidden by default) */
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }

  /* Links inside the dropdown */
  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  /* Show the dropdown menu on hover */
  .dropdown:hover .dropdown-content {
    display: block;
  }

/* Large devices (laptops/desktops, 992px to 768px ) */
@media only screen and (max-width: 1178px) {
  .navbar-menu {
    display: none;}

}
</style></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/Concordium" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="mailto:support@concordium.software" title="Support" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://developer.concordium.software/en/mainnet/net/guides/developer-page.html#block-explorers" title="Monitor" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-chart-line fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Monitor</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://support.concordium.software/latest" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCPZc2CuB2jGbZjD_5zX7-1A" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://medium.com/concordium" title="Medium" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-medium fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Medium</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://academy.concordium.software/ccd-academy/getting-started" title="Academy" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-graduation-cap fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Academy</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><style>
body {margin:0;}

.navbar-menu {
  position: relative;
  margin-left: 190px;
  background: none;
}

.navbar-light {
    background: #ededed!important;
    box-shadow: none;
}

.navbar-menu a {
  float: left;
  display: inline;
  text-align: center;
  color: var(--font-color);
  font-size: 15px;
}

/* Dropdown Button */
.dropbtn {
  background: none;
  color: black;
  font-size: 16px;
  font-weight: 600;
  padding-left: 20px;
  padding-right: 20px;
  border: none;
  font-family: inherit; /* Important for vertical align on mobile phones */
  margin: 0; /* Important for vertical align on mobile phones */
}

/* The dropdown container */
.dropdown {
    float: left;
  }

  /* Dropdown content (hidden by default) */
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }

  /* Links inside the dropdown */
  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  /* Show the dropdown menu on hover */
  .dropdown:hover .dropdown-content {
    display: block;
  }

/* Large devices (laptops/desktops, 992px to 768px ) */
@media only screen and (max-width: 1178px) {
  .navbar-menu {
    display: none;}

}
</style></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/Concordium" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="mailto:support@concordium.software" title="Support" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://developer.concordium.software/en/mainnet/net/guides/developer-page.html#block-explorers" title="Monitor" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-chart-line fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Monitor</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://support.concordium.software/latest" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCPZc2CuB2jGbZjD_5zX7-1A" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://medium.com/concordium" title="Medium" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-medium fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Medium</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://academy.concordium.software/ccd-academy/getting-started" title="Academy" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-graduation-cap fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Academy</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Releases and Installation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/installation/downloads.html">Downloads</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/installation/verification-instructions.html">Verification instructions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/release-notes/release-notes-lp.html">Release notes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concordium Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/learn-about-concordium.html">Learn about Concordium</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/concepts/id-accounts.html">Identities</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/company-identities.html">Company identity creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/manage-accounts.html">Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/glossary.html">Glossary of Concordium Terms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/wallets-lp.html">Concordium wallets</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/guides/wallet-faqs.html">Wallet FAQs</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/deciding-wallet.html">Deciding between the wallets</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/concepts/concepts-transactions.html">Transactions overview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet-gen2/faq.html">Concordium Wallet for Mobile FAQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/browser-wallet/browser-wallet-faq.html">Concordium Wallet for Web FAQ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/guides/setup-wallets-lp.html">Set up a wallet</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/browser-wallet/setup-browser-wallet.html">Set up the Concordium Wallet for Web</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet-gen2/setup-mobile-wallet.html">Set up the Concordium Wallet for Mobile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet/setup-mobile-wallet.html">Set up the Concordium Legacy Wallet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/overview-desktop.html">Set up the Desktop Wallet</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/guides/manage-wallets-lp.html">Wallet activities</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/create-identity.html">Create an identity</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/change-identity-name.html">Change identity name</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/create-account.html">Create an account</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/change-account-name.html">Change account name</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/export-key.html">Export a private key</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/recovery.html">Backup and recovery</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/export-import.html">Make a backup of identities, accounts, and addresses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/recover-wallet.html">Recover your Wallet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet/change-passcode-mw.html">Update your passcode and biometric settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/address-book.html">Manage address book</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/transaction-report.html">Create a transaction report</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/guides/account-activities-lp.html">Account activities</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/send-ccd-wallets.html">Send CCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet/share-address-mw.html">Find and share your account address</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/browser-wallet/connect-app.html">Connect dApps to wallets</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/proofs.html">Proofs and revealing information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/tokens.html">Tokens in the wallet</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/shield-ccd-wallets.html">Shield and unshield CCD on an account</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/shielded-transfer.html">Make a shielded transfer on an account</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/scheduled-release.html">Scheduled releases</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/desktop-wallet/single-sign-schedule.html">Transfer CCD with a schedule in Desktop Wallet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/mobile-wallet/inspect-release-schedule-mw.html">Inspect a release schedule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/desktop-wallet/dw-lp.html">Desktop Wallet</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/desktop-wallet/single-sign-schedule.html">Transfer CCD with a schedule in Desktop Wallet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/desktop-wallet/transaction-log-filter.html">Apply a transaction log filter in the Desktop Wallet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/desktop-wallet/update-application.html">Update the Desktop Wallet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/desktop-wallet/accounts-desktop.html">Desktop Wallet navigation and settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/desktop-wallet/reset-data.html">Reset desktop wallet data</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../net/guides/overview-shared-accounts.html">Shared accounts with multiple credentials in Desktop Wallet</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../net/desktop-wallet/create-credentials-file.html">Create a credentials file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/multi-credentials.html">Add credentials to an account</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/desktop-wallet/multisig-simple-transfer.html">Create a multi-signature CCD transfer in the Desktop Wallet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/guides/multisig-transfer.html">Create a scheduled transfer in the Desktop Wallet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/desktop-wallet/sign-transaction.html">Sign a transaction proposal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../net/desktop-wallet/proposed-transactions.html">View transaction proposals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/how-to-earn.html">Staking with Concordium</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/concepts/concepts-baker.html">Validators</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/baker-pool.html">Validator management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet/add-baker-mw.html">Add a validator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mobile-wallet/update-baker-mw.html">Change validator options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/baker-windows.html">Run a validator node on Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/baker-macos.html">Run a validator node on macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/baker-ubuntu.html">Run a validator node on Ubuntu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/baker-docker.html">Run a validator node on Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/become-baker.html">Become a validator using the Concordium Client</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/concepts/concepts-delegation.html">Delegation</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/add-delegation.html">Delegate to a staking pool or passive delegation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/update-delegation.html">Update delegation to a staking pool or passive delegation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/remove-delegation.html">Remove delegation to a staking pool or passive delegation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/snippets/delegation-faq.html">Delegation and validation FAQ</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Develop on Concordium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/developer-page.html">Developer resources</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/sdks-apis.html">SDKs and APIs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk.html">Wallet SDK</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk-identity-creation.html">Create an identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk-identity-recovery.html">Recover an identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk-credential-deployment.html">Create an account</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk-account-transaction.html">Submit a transaction to a Concordium node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/wallet-sdk/wallet-sdk-identity-provider.html">Get the list of identity providers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/dapp-examples.html">dApp examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/dashboards.html">Status Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/developer-tools.html">Auxiliary Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/grpc2.html">gRPC V2 documentation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/nodes/node-requirements.html">Run a node on Concordium</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/nodes/ubuntu.html">Ubuntu nodes</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/run-node-ubuntu.html">Run a node on a server with Ubuntu on Mainnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/run-node-ubuntu.html">Run a node on a server with Ubuntu on Testnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/troubleshoot-ubuntu.html">Troubleshoot a node on a server with Ubuntu</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/nodes/macos.html">MacOS nodes</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/run-node-macos.html">Run and manage a node on macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/troubleshoot-macos.html">Troubleshoot a node on MacOS</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/nodes/windows.html">Windows nodes</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/run-node-windows.html">Run and manage a node on Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/node-runner-service-configuration.html">Concordium Windows node runner service configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/troubleshoot-windows.html">Troubleshoot a node running on Windows</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../net/nodes/docker.html">Docker nodes</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../net/guides/run-node.html">Run a node with Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/nodes/troubleshoot-docker.html">Troubleshoot a node on a server with Docker</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/references/concordium-client.html">Concordium Client</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/transactions.html">Concordium Client transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/query-node.html">Querying a node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/references/multi-sig.html">Multi-sig</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/guides/run-local-chain.html">Run a local chain</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/web3-id/index.html">Use Concordium's ID layer</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/web3-id/wallet.html">Web3 ID in the Concordium Wallet for Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/web3-id/issuer.html">Web3 ID issuers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/create-proofs.html">Create proofs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/web3-id/concordia.html">Concordia</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/low-code-nft-marketplace/introduction.html">Concordium low-code NFT framework</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/low-code-nft-marketplace/marketplace.html">Low code NFT marketplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/low-code-nft-marketplace/minting-tool.html">Low-code NFT minting tool</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/resources/ccd-scan.html">CCDScan</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/ccd-scan-blocks.html">CCDScan Blocks overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/ccd-scan-transactions.html">CCDScan Transactions overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/ccd-scan-accounts.html">CCDScan Accounts overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/ccd-scan-staking.html">CCDScan Staking overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/resources/ccd-scan-nodes.html">CCDScan Nodes overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://proposals.concordium.software/index.html">Concordium Standards</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Indexers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../net/indexers/intro.html">What are indexers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/indexers/subquery.html">SubQuery</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Smart Contracts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/general/introduction.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/general/contract-lifecycle.html">Life cycle of a smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/general/contract-module.html">Smart contract modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/general/contract-instances.html">Smart contract instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/general/contract-schema.html">Smart contract schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/general/develop-contracts.html">Develop smart contracts in Rust</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../smart-contracts/guides/quick-start.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../smart-contracts/onboarding-guide-ethereum-developers/faq.html">Ethereum developer onboarding</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/onboarding-guide-solana-developers/overview.html">Solana developer onboarding</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/onboarding-guide-solana-developers/faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/guides/contract-dev-guides.html">Contract development guides</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/setup-tools.html">Install tools for development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/setup-contract.html">Set up a smart contract project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/compile-module.html">Compile a Rust smart contract module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/custom-errors.html">Return custom errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/build-schema.html">Build a contract schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/no-std.html">Build using <code class="docutils literal notranslate"><span class="pre">no_std</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/fallback-entrypoints.html">Fallback entrypoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/upgradeable-contract.html">Make a contract upgradeable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/json-params.html">Work with the JSON parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/migrate-contracts.html">Migrate contracts for <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code> 8.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/factory-pattern.html">Using the factory pattern on Concordium</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../smart-contracts/guides/integration-test-contract.html">Test contracts</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/guides/on-chain-index.html">On-chain guides</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/deploy-module.html">Deploy a smart contract module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/initialize-contract.html">Initialize a smart contract instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/interact-instance.html">Interact with a smart contract instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/inspect-instance.html">Inspect a smart contract instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/guides/invoke-instance.html">Invoke a smart contract instance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/best-practices/index.html">Best practices</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/best-practices/development.html">Development best practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/best-practices/costs.html">Cost reduction best practices</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/references/index.html">References</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/crypto-primitives.html">Cryptographic primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/host-fns.html">Contract host functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/local-settings.html">Local settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/references-on-chain.html">References on-chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/schema-json.html">Schema JSON representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/references/simulate-context.html">Simulation contexts</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/Concordium/concordium-rust-smart-contracts">Rust contract examples (repo)</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/">concordium-std</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../sc-v0-rollup.html">V0 smart contracts</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../general/introduction.html">Introduction and general guides</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/contract-module.html">Smart contract modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/contract-instances.html">Smart contract instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/contract-schema.html">Smart contract schemas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/develop-contracts.html">Developing smart contracts in Rust</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="writing.html">Writing the piggy bank smart contract</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Testing the piggy bank smart contract</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/contract-dev-guides.html">Contract development guides</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/setup-tools.html">Install tools for development</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/setup-contract.html">Setting up a smart contract project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/compile-module.html">Compile a Rust smart contract module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/unit-test-contract.html">Unit test a contract in Rust</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/custom-errors.html">Return custom errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/local-simulate.html">Locally simulate contract functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/build-schema.html">Build a contract schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/no-std.html">Build using <code class="docutils literal notranslate"><span class="pre">no_std</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/on-chain-index.html">On-chain guides</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-42"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/deploy-module.html">Deploy a smart contract module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/initialize-contract.html">Initialize a smart contract instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/interact-instance.html">Interact with a smart contract instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/inspect-instance.html">Inspect a smart contract instance</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../references/index.html">References</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-43"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/schema-json.html">Schema JSON representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/simulate-context.html">Simulation contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/host-fns.html">Contract host functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/references-on-chain.html">References on-chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/local-settings.html">Local settings</a></li>
<li class="toctree-l3"><a class="reference external" href="https://github.com/Concordium/concordium-rust-smart-contracts">Rust contract examples (repo)</a></li>
<li class="toctree-l3"><a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/">concordium-std</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/index.html">Smart contract tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-44"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/tutorials/setup-env.html">Setup the development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smart-contracts/tutorials/counter/counter-contract.html">Counter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/index.html">PiggyBank</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-45"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/writing.html">Writing the piggy bank smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/testing.html">Testing the piggy bank smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/deploying.html">Deploying the piggy bank smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/frontend.html">Setting up a front end</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/wCCD/index.html">wCCD</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-46"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/wCCD/wCCD-introduction.html">Understanding the wCCD token protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/wCCD/wCCD-interacting.html">Interacting with the wCCD token protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/wCCD/wCCD-front-end-set-up.html">Setting up the front end</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/wCCD/wCCD-full-dApp.html">Running your first full dApp</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/voting/index.html">The Voting dApp</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-47"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/voting/voting-sc.html">Writing a voting smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/voting/voting-dapp.html">Setting up the front-end</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-minting/index.html">Mint an NFT</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-48"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-minting/upload-nft.html">Upload the NFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-minting/build-smart-contract.html">Initialize, build, and deploy the smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-minting/mint-xfer.html">Mint and transfer the NFT</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/sft-minting/index.html">Mint a semi-fungible token</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-49"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sft-minting/setup.html">Setup the development environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sft-minting/build-smart-contract.html">Smart contract modifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sft-minting/mint-xfer.html">Mint and transfer semi-fungible token</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/fungible-tokens/index.html">Mint fungible tokens</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-50"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/fungible-tokens/smart-contract.html">Smart contract implementation for fungible tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/fungible-tokens/mint-xfer.html">Mint, transfer, and burn fungible tokens</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-marketplace/index.html">NFT marketplace smart contract tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-51"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/nft-marketplace/smart-contract.html">Build and deploy the smart contract</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/eSealing/index.html">eSealing</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-52"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/eSealing/eSealing_dapp.html">Exploring the eSealing dapp</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/sponsoredTransactions/index.html">Sponsored Transactions</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-53"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sponsoredTransactions/sponsoredTransactionsSmartContract.html">Exploring the sponsored Transactions Smart Contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sponsoredTransactions/sponsoredTransactionsFrontendAndBackend.html">Exploring the sponsored Transactions dApp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/sponsoredTransactions/walletConnect.html">Wallet Connect</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../smart-contracts/tutorials/smartContractUpgrade/index.html">Smart Contract Upgrade</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-54"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../smart-contracts/tutorials/smartContractUpgrade/smartContractUpgrade.html">Native upgradability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../net/guides/gallery/index.html">Using ID tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-55"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/gallery/gallery-backend.html">Writing the verifying backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/gallery/gallery-frontend.html">Interacting with a wallet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/guides/gallery/gallery-setup.html">Setting up the front end</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Governance Committee Voting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../net/voting/gc-voting.html">Concordium Governance Committee Elections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/voting/coordinator.html">Election coordinator tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/voting/voting.html">How to vote</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/voting/guardians.html">Guardians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../net/voting/verify-election-result.html">Verify election result</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../net/index.html" class="nav-link">index</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">The piggy bank smart contract</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Testing the...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="testing-the-piggy-bank-smart-contract">
<span id="piggy-bank-testing-v0"></span><h1>Testing the piggy bank smart contract<a class="headerlink" href="#testing-the-piggy-bank-smart-contract" title="Link to this heading">#</a></h1>
<p>This is the second <a class="reference internal" href="../../../smart-contracts/tutorials/piggy-bank/index.html#piggy-bank"><span class="std std-ref">part of a tutorial</span></a> on smart contract
development.
So far you have written a piggy bank smart contract in the <a class="reference external" href="https://www.rust-lang.org/">Rust</a> programming
language.
This part will focus on how you can write unit tests for your piggy bank smart
contract and how to setup and locally simulate an invocation of a smart
contract.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The reader is assumed to have basic knowledge of what a blockchain and smart
contract is, and some experience with <a class="reference external" href="https://www.rust-lang.org/">Rust</a>.</p>
</div>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#preparation" id="id2">Preparation</a></p></li>
<li><p><a class="reference internal" href="#add-a-test-module" id="id3">Add a test module</a></p></li>
<li><p><a class="reference internal" href="#testing-instantiation-of-a-piggy-bank" id="id4">Testing instantiation of a piggy bank</a></p></li>
<li><p><a class="reference internal" href="#test-inserting-ccd-into-a-piggy-bank" id="id5">Test inserting CCD into a piggy bank</a></p></li>
<li><p><a class="reference internal" href="#test-smashing-a-piggy-bank" id="id6">Test smashing a piggy bank</a></p></li>
<li><p><a class="reference internal" href="#testing-cause-of-rejection" id="id7">Testing cause of rejection</a></p></li>
<li><p><a class="reference internal" href="#compiling-and-running-tests-in-wasm" id="id8">Compiling and running tests in Wasm</a></p></li>
<li><p><a class="reference internal" href="#simulating-the-piggy-bank" id="id9">Simulating the piggy bank</a></p></li>
</ul>
</nav>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">#</a></h2>
<p>Before you start, make sure to have the necessary tooling to build Rust
contracts.
The guide <a class="reference internal" href="../../../smart-contracts/guides/setup-tools.html#setup-tools"><span class="std std-ref">Install tools for development</span></a> shows you how to do this.
Also, make sure to have a text editor setup to write Rust.</p>
<p>Additionally, to run the tests you need to:</p>
<ul class="simple">
<li><p>set up a local testnet node using your preferred platform: <a class="reference internal" href="../../../net/nodes/windows.html#windows-node"><span class="std std-ref">Windows</span></a>, <a class="reference internal" href="../../../net/nodes/macos.html#macos-node"><span class="std std-ref">MacOS</span></a>, <a class="reference internal" href="../../../net/nodes/ubuntu.html#ubuntu-node"><span class="std std-ref">Ubuntu</span></a>, or <a class="reference internal" href="../../../net/nodes/docker.html#docker-node"><span class="std std-ref">Docker/Linux</span></a></p></li>
<li><p><a class="reference internal" href="../../../net/guides/create-account.html#create-account"><span class="std std-ref">create an account for testnet</span></a>. The account will need some CCD to run tests.</p></li>
<li><p><a class="reference internal" href="../../../net/references/concordium-client.html#concordium-client-import-accounts-keys"><span class="std std-ref">import the created account using concordium-client</span></a></p></li>
<li><p><a class="reference internal" href="../../guides/deploy-module.html#deploy-module-v0"><span class="std std-ref">deploy the smart contract to your local testnet node</span></a>.</p></li>
</ul>
<p>Since you are going to extend the smart contract code written in the <a class="reference internal" href="writing.html#piggy-bank-writing-v0"><span class="std std-ref">previous
part</span></a>, either follow the previous part or copy the resulting code from there.</p>
<p>You are now ready to write unit tests for your smart contract!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To request CCDs for testing, use the buttons in the Concordium Wallets when running Testnet.</p>
</div>
</section>
<section id="add-a-test-module">
<h2>Add a test module<a class="headerlink" href="#add-a-test-module" title="Link to this heading">#</a></h2>
<p>Since a smart contract module is written as a Rust library, you can test it as
one would test any library and write unit-tests as part of the Rust module.</p>
<p>At the bottom of the <code class="docutils literal notranslate"><span class="pre">lib.rs</span></code> file containing our code, make sure you have the
following starting point:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="c1">// PiggyBank contract code up here</span>

<span class="cp">#[cfg(test)]</span>
<span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This is your test module, which is a common pattern for writing unit tests in
Rust, so the above code will not be explained here.</p>
<p>Test the contract functions just as if they were regular functions by
calling the functions you have annotated with <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a> and <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.receive.html"><code class="docutils literal notranslate"><span class="pre">#[receive]</span></code></a>.</p>
<p>But in order to call them, you will need to first construct the arguments.
Luckily <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/index.html"><code class="docutils literal notranslate"><span class="pre">concordium-std</span></code></a> contains a submodule <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/test_infrastructure/index.html"><code class="docutils literal notranslate"><span class="pre">test_infrastructure</span></code></a> with
stubs for this, so first bring everything from the submodule into scope.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[cfg(test)]</span>
<span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span>
<span class="hll"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">test_infrastructure</span>::<span class="o">*</span><span class="p">;</span>
</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you can start adding tests to this module.</p>
</section>
<section id="testing-instantiation-of-a-piggy-bank">
<h2>Testing instantiation of a piggy bank<a class="headerlink" href="#testing-instantiation-of-a-piggy-bank" title="Link to this heading">#</a></h2>
<p>The first test to add is to verify a piggy bank is set up with the correct
state.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="fm">todo!</span><span class="p">(</span><span class="s">&quot;Implement&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As mentioned above, you test the initialization by calling the function
<code class="docutils literal notranslate"><span class="pre">piggy_init</span></code> directly.
To construct its argument for, you use <a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/type.InitContextTest.html"><code class="docutils literal notranslate"><span class="pre">InitContextTest</span></code></a> which provides a
placeholder for the context.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitContextTest</span>::<span class="n">empty</span><span class="p">();</span>
</pre></div>
</div>
<p>Just as the name suggests, the test context is empty and if any of the getter
functions are called, it will make sure to fail the test, which should be fine
for now since the piggy bank is not reading anything from the context.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As you will see later with the <a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/type.ReceiveContextTest.html"><code class="docutils literal notranslate"><span class="pre">ReceiveContextTest</span></code></a>, these placeholders have
setter functions, allowing us to partially specify the context.</p>
</div>
<p>Now you can call <code class="docutils literal notranslate"><span class="pre">piggy_init</span></code> and get a result containing the initial state.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">state_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">);</span>
</pre></div>
</div>
<p>First, you want the test to fail if the contract did not result in an
initial state:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state_result</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Contract initialization results in error.&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Next you assert the state is correctly set to <code class="docutils literal notranslate"><span class="pre">Intact</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="fm">assert_eq!</span><span class="p">(</span>
<span class="w">   </span><span class="n">state</span><span class="p">,</span>
<span class="w">   </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span>
<span class="w">   </span><span class="s">&quot;Piggy bank state should be intact after initialization.&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Putting it all together, you end up with the following test for initializing a
piggy bank:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="c1">// PiggyBank contract code up here</span>

<span class="cp">#[cfg(test)]</span>
<span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">test_infrastructure</span>::<span class="o">*</span><span class="p">;</span>

<span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">test_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitContextTest</span>::<span class="n">empty</span><span class="p">();</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">state_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state_result</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Contract initialization results in error.&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span>
<span class="w">            </span><span class="n">state</span><span class="p">,</span>
<span class="w">            </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;Piggy bank state should be intact after initialization.&quot;</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Run the test to check that it compiles and succeeds.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span>cargo<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
</section>
<section id="test-inserting-ccd-into-a-piggy-bank">
<h2>Test inserting CCD into a piggy bank<a class="headerlink" href="#test-inserting-ccd-into-a-piggy-bank" title="Link to this heading">#</a></h2>
<p>Next you should test the different functions for interacting with a piggy bank.
This is done in the same way as initializing, except you use <code class="docutils literal notranslate"><span class="pre">ReceiveContextTest</span></code>
to construct the context.</p>
<p>To test <code class="docutils literal notranslate"><span class="pre">piggy_insert</span></code> you also need some amount of CCD and the current state
of your smart contract instance:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>
</pre></div>
</div>
<p>When calling <code class="docutils literal notranslate"><span class="pre">piggy_insert</span></code> you get back a result with actions instead of an
initial state as with <code class="docutils literal notranslate"><span class="pre">piggy_init</span></code>. But you will need to help the compiler
infer which type to use for the generic <code class="docutils literal notranslate"><span class="pre">A</span></code> implementing <a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/trait.HasActions.html"><code class="docutils literal notranslate"><span class="pre">HasActions</span></code></a>, so
add the result type <code class="docutils literal notranslate"><span class="pre">ReceiveResult&lt;ActionsTree&gt;</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_insert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</pre></div>
</div>
<p>For testing you can represent the actions as a simple tree structure
<a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/enum.ActionsTree.html"><code class="docutils literal notranslate"><span class="pre">ActionsTree</span></code></a>, making it easy to inspect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">#[receive]</span></code> macro uses another representation of the actions, when building
the smart contract module. This representation depends on functions supplied
by the host environment and is therefore not suitable for unit tests.</p>
</div>
<p>Now you need to check if the function succeeded and verify the resulting state and actions.
In this case the state should remain intact and the function produce only the action for accepting the CCD.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Inserting CCD results in error.&quot;</span><span class="p">);</span>

<span class="fm">assert_eq!</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span><span class="w"> </span><span class="n">ActionsTree</span>::<span class="n">accept</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;No action should be produced.&quot;</span><span class="p">);</span>
<span class="fm">assert_eq!</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Piggy bank state should still be intact.&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>The second test becomes:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_insert_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_insert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Inserting CCD results in error.&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span><span class="w"> </span><span class="n">ActionsTree</span>::<span class="n">accept</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;No action should be produced.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Piggy bank state should still be intact.&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Again you should verify everything compiles and the tests succeeds using <code class="docutils literal notranslate"><span class="pre">cargo</span>
<span class="pre">test</span></code>.</p>
<p>Next you could add a test to check that inserting into a piggy bank with state
<code class="docutils literal notranslate"><span class="pre">Smashed</span></code> results in an error. You have been through everything needed to
do this, and can do this exercise on your own.</p>
</section>
<section id="test-smashing-a-piggy-bank">
<h2>Test smashing a piggy bank<a class="headerlink" href="#test-smashing-a-piggy-bank" title="Link to this heading">#</a></h2>
<p>Testing <code class="docutils literal notranslate"><span class="pre">piggy_smash</span></code> will follow the same pattern, but this time you will need
to populate the context since this function uses the context for getting the
contract owner, the sender of the message triggering the function, and the
balance of contract.</p>
<p>If you only supply the function with an empty context it will fail, so instead
define the context as mutable:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
</pre></div>
</div>
<p>Create an <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/struct.AccountAddress.html"><code class="docutils literal notranslate"><span class="pre">AccountAddress</span></code></a> to represent the owner and use the setter
<code class="docutils literal notranslate"><span class="pre">set_owner</span></code> implemented on <a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/type.ReceiveContextTest.html"><code class="docutils literal notranslate"><span class="pre">ReceiveContextTest</span></code></a>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice you created the account address using an array of 32 bytes, which is
how account addresses are represented on the Concordium blockchain.
These byte arrays can also be represented as a base58check encoding, but for
testing it is usually more convenient to specify addresses directly in bytes.</p>
</div>
<p>Next set the sender to be the same address as the owner using <a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/type.ReceiveContextTest.html#method.set_sender"><code class="docutils literal notranslate"><span class="pre">set_sender</span></code></a>.
Since the sender can be a contract instance as well, you must wrap the owner
address in the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/enum.Address.html"><code class="docutils literal notranslate"><span class="pre">Address</span></code></a> type:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
</pre></div>
</div>
<p>Lastly, you need to set the current balance of the piggy bank instance using
<a class="reference external" href="https://docs.rs/concordium-std/2.0.0/concordium_std/test_infrastructure/type.ReceiveContextTest.html#method.set_self_balance"><code class="docutils literal notranslate"><span class="pre">set_self_balance</span></code></a>.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>
</pre></div>
</div>
<p>Now that you have the test context setup, call the contract function
<code class="docutils literal notranslate"><span class="pre">piggy_smash</span></code> and inspect the resulting action tree and state as you did
in the previous tests:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_smash_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Inserting CCD results in error.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span><span class="w"> </span><span class="n">ActionsTree</span>::<span class="n">simple_transfer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">));</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Smashed</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ensure everything compiles and the test succeeds using <code class="docutils literal notranslate"><span class="pre">cargo</span> <span class="pre">test</span></code>.</p>
</section>
<section id="testing-cause-of-rejection">
<h2>Testing cause of rejection<a class="headerlink" href="#testing-cause-of-rejection" title="Link to this heading">#</a></h2>
<p>You want to test that the piggy bank rejects in certain contexts, for example
when someone besides the owner of the smart contract tries to smash it.</p>
<p>The test should:</p>
<ul class="simple">
<li><p>Make a context where the sender and owner are two different accounts.</p></li>
<li><p>Set the state to be intact.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">piggy_smash</span></code>.</p></li>
<li><p>Check that the result is an error.</p></li>
</ul>
<p>The test could look like this:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_smash_intact_not_owner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">1</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]));</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="w">    </span><span class="fm">assert!</span><span class="p">(</span><span class="n">actions_result</span><span class="p">.</span><span class="n">is_err</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Contract is expected to fail.&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>One thing to notice is that the test is not ensuring <em>why</em> the contract
rejected; your piggy bank might reject for a wrong reason and this would be a
bug.
This is probably fine for a simple smart contract like your piggy bank, but for a
smart contract with more complex logic and many reasons for rejecting, it would
be better if you tested this as well.</p>
<p>To solve this, introduce a <code class="docutils literal notranslate"><span class="pre">SmashError</span></code> enum  to represent the different
reasons for rejection:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[derive(Debug, PartialEq, Eq, Reject)]</span>
<span class="k">enum</span> <span class="nc">SmashError</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NotOwner</span><span class="p">,</span>
<span class="w">    </span><span class="n">AlreadySmashed</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more information about custom errors and deriving <code class="docutils literal notranslate"><span class="pre">Reject</span></code>, see <a class="reference internal" href="../../../smart-contracts/guides/custom-errors.html#custom-errors"><span class="std std-ref">Return custom errors</span></a>.</p>
</div>
<p>To use this error type, the function <code class="docutils literal notranslate"><span class="pre">piggy_smash</span></code> should return <code class="docutils literal notranslate"><span class="pre">Result&lt;A,</span>
<span class="pre">SmashError&gt;</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ReceiveResult&lt;A&gt;</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;smash&quot;</span><span class="cp">)]</span>
<span class="k">fn</span> <span class="nf">piggy_smash</span><span class="o">&lt;</span><span class="n">A</span>: <span class="nc">HasActions</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">impl</span><span class="w"> </span><span class="n">HasReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">,</span>
<span class="hll"><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">   </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and you also have to supply the <code class="docutils literal notranslate"><span class="pre">ensure!</span></code> macros with a second argument, which is
the error to produce:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;smash&quot;</span><span class="cp">)]</span>
<span class="k">fn</span> <span class="nf">piggy_smash</span><span class="o">&lt;</span><span class="n">A</span>: <span class="nc">HasActions</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">impl</span><span class="w"> </span><span class="n">HasReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">();</span>

<span class="hll"><span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">sender</span><span class="p">.</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">),</span><span class="w"> </span><span class="n">SmashError</span>::<span class="n">NotOwner</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span>::<span class="n">AlreadySmashed</span><span class="p">);</span>
</span>
<span class="w">    </span><span class="o">*</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Smashed</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">self_balance</span><span class="p">();</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">A</span>::<span class="n">simple_transfer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the return type has changed for the <code class="docutils literal notranslate"><span class="pre">piggy_smash</span></code> function, you have to
change the type in the tests as well:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_smash_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nb">Result</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_smash_intact_not_owner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nb">Result</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can now check which error was produced in the test:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[test]</span>
<span class="k">fn</span> <span class="nf">test_smash_intact_not_owner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">1</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]));</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nb">Result</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect_err</span><span class="p">(</span><span class="s">&quot;Contract is expected to fail.&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span>::<span class="n">NotOwner</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Expected to fail with error NotOwner&quot;</span><span class="p">)</span>
</span><span class="p">}</span>
</pre></div>
</div>
<p>It is up to the reader to test whether smashing a piggy bank that has
already been smashed results in the correct error.</p>
</section>
<section id="compiling-and-running-tests-in-wasm">
<h2>Compiling and running tests in Wasm<a class="headerlink" href="#compiling-and-running-tests-in-wasm" title="Link to this heading">#</a></h2>
<p>When running <code class="docutils literal notranslate"><span class="pre">cargo</span> <span class="pre">test</span></code> your contract module and tests are compiled targeting
your native platform, but on the Concordium blockchain a smart contract module
is in Wasm.
Therefore it is preferable to compile the tests targeting Wasm and run the tests
using a Wasm interpreter instead.
Luckily, the <code class="docutils literal notranslate"><span class="pre">cargo-concordium</span></code> tool contains such an interpreter, and
it is the same interpreter shipped with the official nodes on the Concordium
blockchain.</p>
<p>Before you can run tests in Wasm, you have to replace <code class="docutils literal notranslate"><span class="pre">#[cfg(test)]</span></code> at the
top of your test module with <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.concordium_cfg_test.html"><code class="docutils literal notranslate"><span class="pre">#[concordium_cfg_test]</span></code></a> and all the <code class="docutils literal notranslate"><span class="pre">#[test]</span></code>
macros with <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.concordium_test.html"><code class="docutils literal notranslate"><span class="pre">#[concordium_test]</span></code></a>.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="c1">// PiggyBank contract code up here</span>

<span class="hll"><span class="cp">#[concordium_cfg_test]</span>
</span><span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">test_infrastructure</span>::<span class="o">*</span><span class="p">;</span>

<span class="hll"><span class="w">    </span><span class="cp">#[concordium_test]</span>
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">test_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>

<span class="hll"><span class="w">    </span><span class="cp">#[concordium_test]</span>
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">test_insert_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>

<span class="hll"><span class="w">    </span><span class="cp">#[concordium_test]</span>
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">test_smash_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>

<span class="hll"><span class="w">    </span><span class="cp">#[concordium_test]</span>
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">test_smash_intact_not_owner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You also need to modify the tests a bit. Usually a test in <a class="reference external" href="https://www.rust-lang.org/">Rust</a> is failed
by panicking with an error message, but when compiling to Wasm this error
message is lost.
Instead you need generate code reporting the error back to the host who is
running the Wasm. To do so, <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code> provides replacements:</p>
<ul class="simple">
<li><p>A call to <code class="docutils literal notranslate"><span class="pre">panic!</span></code> should be replaced with <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/macro.fail.html"><code class="docutils literal notranslate"><span class="pre">fail!</span></code></a>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">expect</span></code> and <code class="docutils literal notranslate"><span class="pre">expect_err</span></code> function should be replaced with
<a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/trait.ExpectReport.html#tymethod.expect_report"><code class="docutils literal notranslate"><span class="pre">expect_report</span></code></a> and <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/trait.ExpectErrReport.html#tymethod.expect_err_report"><code class="docutils literal notranslate"><span class="pre">expect_err_report</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert</span></code> and <code class="docutils literal notranslate"><span class="pre">assert_eq</span></code> should be replaced with <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/macro.claim.html"><code class="docutils literal notranslate"><span class="pre">claim!</span></code></a> and <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/macro.claim_eq.html"><code class="docutils literal notranslate"><span class="pre">claim_eq!</span></code></a>
respectively.</p></li>
</ul>
<p>All of these macros are wrappers, which behave the same as their counterpart
except when you build your smart contract for testing in Wasm using
<code class="docutils literal notranslate"><span class="pre">cargo-concordium</span></code>. This means you can still run tests for targeting native
using <code class="docutils literal notranslate"><span class="pre">cargo</span> <span class="pre">test</span></code>.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="c1">// PiggyBank contract code up here</span>

<span class="cp">#[concordium_cfg_test]</span>
<span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="o">*</span><span class="p">;</span>
<span class="w">   </span><span class="k">use</span><span class="w"> </span><span class="n">test_infrastructure</span>::<span class="o">*</span><span class="p">;</span>

<span class="w">   </span><span class="cp">#[concordium_test]</span>
<span class="w">   </span><span class="k">fn</span> <span class="nf">test_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitContextTest</span>::<span class="n">empty</span><span class="p">();</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">state_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">);</span>

<span class="hll"><span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state_result</span><span class="p">.</span><span class="n">expect_report</span><span class="p">(</span><span class="s">&quot;Contract initialization failed.&quot;</span><span class="p">);</span>
</span>
<span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span>
</span><span class="w">             </span><span class="n">state</span><span class="p">,</span>
<span class="w">             </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span>
<span class="w">             </span><span class="s">&quot;Piggy bank state should be intact after initialization.&quot;</span>
<span class="w">       </span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="cp">#[concordium_test]</span>
<span class="w">   </span><span class="k">fn</span> <span class="nf">test_insert_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_insert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="hll"><span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect_report</span><span class="p">(</span><span class="s">&quot;Inserting CCD results in error.&quot;</span><span class="p">);</span>
</span>
<span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span><span class="w"> </span><span class="n">ActionsTree</span>::<span class="n">accept</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;No action should be produced.&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Piggy bank state should still be intact.&quot;</span><span class="p">);</span>
</span><span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="cp">#[concordium_test]</span>
<span class="w">   </span><span class="k">fn</span> <span class="nf">test_smash_intact</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nb">Result</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="hll"><span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect_report</span><span class="p">(</span><span class="s">&quot;Inserting CCD results in error.&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span><span class="w"> </span><span class="n">ActionsTree</span>::<span class="n">simple_transfer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">));</span>
</span><span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Smashed</span><span class="p">);</span>
</span><span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="cp">#[concordium_test]</span>
<span class="w">   </span><span class="k">fn</span> <span class="nf">test_smash_intact_not_owner</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiveContextTest</span>::<span class="n">empty</span><span class="p">();</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">0</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]);</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_owner</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Address</span>::<span class="n">Account</span><span class="p">(</span><span class="n">AccountAddress</span><span class="p">([</span><span class="mi">1</span><span class="k">u8</span><span class="p">;</span><span class="w"> </span><span class="mi">32</span><span class="p">]));</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_sender</span><span class="p">(</span><span class="n">sender</span><span class="p">);</span>
<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Amount</span>::<span class="n">from_micro_ccd</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">       </span><span class="n">ctx</span><span class="p">.</span><span class="n">set_self_balance</span><span class="p">(</span><span class="n">balance</span><span class="p">);</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span>::<span class="n">Intact</span><span class="p">;</span>

<span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">actions_result</span>: <span class="nb">Result</span><span class="o">&lt;</span><span class="n">ActionsTree</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piggy_smash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>

<span class="hll"><span class="w">       </span><span class="kd">let</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions_result</span><span class="p">.</span><span class="n">expect_err_report</span><span class="p">(</span><span class="s">&quot;Contract is expected to fail.&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">       </span><span class="n">claim_eq</span><span class="o">!</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">SmashError</span>::<span class="n">NotOwner</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Expected to fail with error NotOwner&quot;</span><span class="p">)</span>
</span><span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Compiling and running the tests in Wasm can be done using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span>cargo<span class="w"> </span>concordium<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<p>This will make a special test build of your smart contract module, exporting all
of your tests as functions, and it will then run each of these functions catching
the reported errors.</p>
</section>
<section id="simulating-the-piggy-bank">
<h2>Simulating the piggy bank<a class="headerlink" href="#simulating-the-piggy-bank" title="Link to this heading">#</a></h2>
<p>So far the tests you have written are in <a class="reference external" href="https://www.rust-lang.org/">Rust</a> and have to be compiled alongside
the smart contract module in a test build. This is fine for unit testing, but
this test build is not the actual module that you intend to deploy on the
Concordium blockchain.</p>
<p>You should also test the smart contract wasm module meant for deployment, and you
can use the simulate feature of <code class="docutils literal notranslate"><span class="pre">cargo-concordium</span></code>. It takes a smart contract
wasm module and uses the Wasm interpreter to run a smart contract function in a
given context. For a reference of the context, see <a class="reference internal" href="../../references/simulate-context.html#simulate-context-v0"><span class="std std-ref">Simulation contexts</span></a>.</p>
<p>For more on how to run simulations, see <a class="reference internal" href="../../guides/local-simulate.html#local-simulate-v0"><span class="std std-ref">Locally simulate contract functions</span></a>.</p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><style>
  legend {
    font-size: 12px;
    font-weight:bold ;
  }

  label {
    font-size: 12px;
  }
</style>

<fieldset>
  <legend>Was this article helpful?</legend>
  <input type="radio" id="Yes" name="rating" value="Yes" onclick="_paq.push(['trackEvent', 'Rating', 'ClickYes', 'Yes']);">
  <label for="Yes">Yes</label>
  <input type="radio" id="No" name="rating" value="No" onclick="_paq.push(['trackEvent', 'Rating', 'ClickNo', 'No']);">
  <label for="No">No</label>
</fieldset>

<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  (function() {
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='https://cdn.matomo.cloud/concordium.matomo.cloud/container_8ZIoCz8b.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Tag Manager --></div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="writing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Writing the piggy bank smart contract</p>
      </div>
    </a>
    <a class="right-next"
       href="../../guides/contract-dev-guides.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contract development guides</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-test-module">Add a test module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-instantiation-of-a-piggy-bank">Testing instantiation of a piggy bank</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-inserting-ccd-into-a-piggy-bank">Test inserting CCD into a piggy bank</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-smashing-a-piggy-bank">Test smashing a piggy bank</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-cause-of-rejection">Testing cause of rejection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compiling-and-running-tests-in-wasm">Compiling and running tests in Wasm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-the-piggy-bank">Simulating the piggy bank</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/Concordium/concordium.github.io/edit/main/source/mainnet/smart-contracts-v0/tutorials/piggy-bank/testing.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <!-- Script to change the highlighting of the active menu path and put the sidenav into hamburger for mobile-->
<script>
    const currentMenu = $('.bd-sidenav.current');
    currentMenu.parent().addClass('selected');

    let $togglerIcon = $('.navbar-toggler-icon');
    let $bdSidebar = $('.bd-sidebar');

    $togglerIcon.on( "click", function() {
        let $togglerAttr = $('.navbar-toggler').attr('aria-expanded');
        if ($togglerAttr == 'true') {
            $bdSidebar.parent().removeClass('show');
        } else {
            $bdSidebar.parent().addClass('show');
        }
    } );
</script>
  

  <p class="copyright">
    
      © Copyright 2021 - 2024, Concordium Software ApS.
      <br/>
    
  </p>

  <style>
    .cc {
      position: relative;
      bottom: 0%;
      left: 0%;
    }

    .cc a {
      display: inline-block;
      text-align: left;
      padding-left: 16px;
      padding-bottom: 8px;
      color: black;
      font-size: 8px;
    }
</style>

<div class="cc">
  <a text-decoration=none href="http://creativecommons.org/licenses/by-sa/4.0/">
    <img src="../../../_static/cc-sa-by.png" />
  </a>
  <a text-decoration=none href="../../../net/guides/legal.html" >
    Legal information
  </a>
</div>
  <div id="cookie-consent" class="consent">
    <p>This website only aggregates and analyzes the actions you take here if you allow cookies. If you do not allow cookies, it protects your privacy, but also prevents the owner from learning from your actions and creating a better experience for you and other users.</p><p>Note that if you opt in and you clear your cookies, delete the opt-in cookie, or if you change computers or Web browsers, you will need to perform the opt-in procedure again.</p>
    <button onclick="consentGranted()">Allow</button>
    <button onclick="consentDenied()">Decline</button>
    <a href="https://concordium.com/privacy-policy/">Privacy policy</a>
</div>

<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];

// Save the choice in a cookie
function storeChoice(granted) {
  document.cookie = "cookie-consent=" + granted
}

// Look for a cookie storing the previous choice of the user.
// Returns undefined if no choice was stored, otherwise a boolean for whether the
// user gave consent.
function loadChoice() {
  if (!document.cookie.includes("cookie-consent=")) {
      return undefined;
  }
  return document.cookie.includes("cookie-consent=true")
}

// Removes the cookie consent banner
function removeCookieConsentBanner() {
  document.getElementById("cookie-consent").remove()
}

// Called by the cookie consent banner if granted permission
function consentGranted() {
  storeChoice(true)
  _paq.push(['setCookieConsentGiven']);
  removeCookieConsentBanner()
}

// Called by the cookie consent banner if denied permission
function consentDenied() {
  storeChoice(true)
  removeCookieConsentBanner()
}

const stored = loadChoice();
if (stored) {
 consentGranted()
}

_paq.push(['requireCookieConsent']);
/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);

(function() {
    var u="https://concordium.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/concordium.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();

  // remember tracking consent was given for all subsequent page views and visits
_paq.push(['rememberCookieConsentGiven']);

</script>


<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4771748.js"></script>
<!-- End of HubSpot Embed Code -->

  </body>
</html>