


<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Writing the piggy bank smart contract &#8212; Concordium  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "auto";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=9fde4d7a" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tippy.css?v=124524c4" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=716d1818"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
    <script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
    <script defer="defer" src="../../_static/tippy/tutorials/piggy-bank/writing.956d7ac7-8a44-43f2-8757-3dd9572db97e.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/piggy-bank/writing';</script>
    <link rel="canonical" href="https://docs.concordium.com/en/mainnet/tutorials/piggy-bank/writing.html" />
    <link rel="icon" href="../../_static/concordium-logo-no-text.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Testing the piggy bank smart contract" href="testing.html" />
    <link rel="prev" title="The piggy bank smart contract" href="index.html" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" />

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">We are actively working to enhance our documentation to provide a better experience. Thank you for your patience!</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item"><style>
.navbar-brand img {
    max-height: 200px;
    width: auto;
}
</style>

<div>
    <a href="https://developer.concordium.software/">
        <img class="logo light-logo" src="../../_static/concordium-logo-dark.svg" />
        <img class="logo dark-logo" src="../../_static/concordium-logo.svg" />
    </a>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../docs/index.html">
    Docs
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tools/index.html">
    Tools
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/Concordium" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="mailto:support@concordium.software" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://developer.concordium.software/en/mainnet/net/guides/developer-page.html#block-explorers" title="Monitor" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-chart-line fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Monitor</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://support.concordium.software/latest" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCPZc2CuB2jGbZjD_5zX7-1A" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://medium.com/concordium" title="Medium" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-medium fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Medium</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://academy.concordium.software/ccd-academy/getting-started" title="Academy" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-graduation-cap fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Academy</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../docs/index.html">
    Docs
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tools/index.html">
    Tools
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/Concordium" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="mailto:support@concordium.software" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://developer.concordium.software/en/mainnet/net/guides/developer-page.html#block-explorers" title="Monitor" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-chart-line fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Monitor</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://support.concordium.software/latest" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCPZc2CuB2jGbZjD_5zX7-1A" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://medium.com/concordium" title="Medium" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-medium fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Medium</span></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://academy.concordium.software/ccd-academy/getting-started" title="Academy" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-graduation-cap fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Academy</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Smart Contract Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../setup-env.html">Setup the development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../counter/counter-contract.html">Counter</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">PiggyBank</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Writing the piggy bank smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing the piggy bank smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploying.html">Deploying the piggy bank smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="frontend.html">Setting up a frontend</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../wCCD/index.html">wCCD</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../wCCD/wCCD-introduction.html">Understanding the wCCD token protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wCCD/wCCD-interacting.html">Interacting with the wCCD token protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wCCD/wCCD-frontend-set-up.html">Setting up the frontend</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../voting/index.html">The Voting dApp</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../voting/voting-sc.html">Writing a voting smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../voting/voting-dapp.html">Setting up the frontend</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../nft-minting/index.html">Mint an NFT</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../nft-minting/upload-nft.html">Upload the NFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nft-minting/build-smart-contract.html">Initialize, build, and deploy the smart contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nft-minting/mint-xfer.html">Mint and transfer the NFT</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sft-minting/index.html">Mint a semi-fungible token</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sft-minting/build-smart-contract.html">Smart contract modifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sft-minting/mint-xfer.html">Mint and transfer semi-fungible token</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fungible-tokens/index.html">Mint fungible tokens</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../fungible-tokens/smart-contract.html">Smart contract implementation for fungible tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fungible-tokens/mint-xfer.html">Mint, transfer, and burn fungible tokens</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../low-code-nft-marketplace/introduction.html">Concordium low-code NFT framework</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../low-code-nft-marketplace/marketplace.html">Low code NFT marketplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../low-code-nft-marketplace/minting-tool.html">Low-code NFT minting tool</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../eSealing/index.html">eSealing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../eSealing/eSealing_dapp.html">Exploring the eSealing dapp</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sponsoredTransactions/index.html">Sponsored Transactions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sponsoredTransactions/sponsoredTransactionsSmartContract.html">Exploring the sponsored Transactions Smart Contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sponsoredTransactions/sponsoredTransactionsFrontendAndBackend.html">Exploring the sponsored Transactions dApp</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../smartContractUpgrade/index.html">Smart Contract Upgrade</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../smartContractUpgrade/smartContractUpgrade.html">Native upgradability</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Ressources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../daap-examples/dapp-examples.html"> dApp examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../company-identity/company-identities.html"> How to create a company identity</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="writing-the-piggy-bank-smart-contract">
<span id="piggy-bank-writing"></span><h1>Writing the piggy bank smart contract<a class="headerlink" href="#writing-the-piggy-bank-smart-contract" title="Link to this heading">#</a></h1>
<p>This is the first <a class="reference internal" href="index.html#piggy-bank"><span class="std std-ref">part of a tutorial</span></a> on smart contract
development. In this part you will focus on how to write a smart contract in the
<a class="reference external" href="https://www.rust-lang.org/">Rust</a> programming language using the <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code> library.</p>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">#</a></h2>
<p>Set up a new smart contract project by following the guide <a class="reference internal" href="../../docs/smart-contracts/guides/setup-contract.html#setup-contract"><span class="std std-ref">Set up a project</span></a> and return to this point afterwards.</p>
</section>
<section id="bring-in-the-standard-library">
<h2>Bring in the standard library<a class="headerlink" href="#bring-in-the-standard-library" title="Link to this heading">#</a></h2>
<p>The source code of your smart contract is going to be in the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory,
which already contains a <code class="docutils literal notranslate"><span class="pre">lib.rs</span></code> file, assuming you follow the above guide
to set up your project.</p>
<p>The smart contract template also includes some example tests under the <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory,
which you can delete for now. You will come back to tests later in this tutorial.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">lib.rs</span></code>, start by bringing everything from the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/index.html"><code class="docutils literal notranslate"><span class="pre">concordium-std</span></code></a> library into scope
by adding the line:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">use</span><span class="w"> </span><span class="n">concordium_std</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>
</pre></div>
</div>
<p>This library contains everything needed to write a smart contract. It
provides convenient wrappers around some low-level operations making your code
more readable, and although it is not strictly necessary to use this, it will
save a lot of code for the vast majority of contract developers.</p>
</section>
<section id="piggy-bank-contract">
<h2>Piggy bank contract<a class="headerlink" href="#piggy-bank-contract" title="Link to this heading">#</a></h2>
<p>The contract you are going to build in this tutorial is going to act as a classic
piggy bank. Everyone should be able to put money in the form of CCD into it, but only the owner
can smash it and retrieve the CCD inside. Once the piggy bank has been
smashed, it should not be possible to add CCD to it.</p>
<p>The piggy-bank smart contract is going to contain a function for setting up a
new piggy bank and two functions for updating a piggy bank; one is for everyone
to use for inserting CCD, the other is for the owner to smash the piggy bank and
prevent further interaction. It will also contain a method for everyone to view
the current state and balance of the piggy bank.</p>
</section>
<section id="specifying-the-state">
<h2>Specifying the state<a class="headerlink" href="#specifying-the-state" title="Link to this heading">#</a></h2>
<p>To implement a piggy bank you need to keep track of the amount of CCD it holds,
and you need to know whether it has been smashed. The blockchain will take care
of the first task for you since the chain keeps track of the balance of each smart-contract
instance. Therefore, you only need to maintain whether the piggy bank has been smashed,
which you do as part of the smart contract <em>state</em>.</p>
<p>In Rust you represent this state as an enum with a variant for the piggy bank
being intact and one for it being smashed:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">PiggyBankState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Intact</span><span class="p">,</span>
<span class="w">    </span><span class="n">Smashed</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the state of your smart contract is going to be stored on the blockchain,
you need to specify how the contract state should be serialized.
When using the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/index.html"><code class="docutils literal notranslate"><span class="pre">concordium-std</span></code></a> library, this all boils down to your type
for the contract state having to implement the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/trait.Serialize.html"><code class="docutils literal notranslate"><span class="pre">Serialize</span></code></a> <a class="footnote-reference brackets" href="#s" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> trait exposed by
<a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/index.html"><code class="docutils literal notranslate"><span class="pre">concordium-std</span></code></a>.</p>
<p>Luckily the library already contains implementations for most of the primitives
and standard types in <a class="reference external" href="https://www.rust-lang.org/">Rust</a>, and a <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/derive.Serialize.html">procedural macro for deriving</a>
<a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/trait.Serialize.html"><code class="docutils literal notranslate"><span class="pre">Serialize</span></code></a> for most cases of enums and structs:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[derive(Serialize)]</span>
<span class="k">enum</span><span class="w"> </span><span class="nc">PiggyBankState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Intact</span><span class="p">,</span>
<span class="w">    </span><span class="n">Smashed</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Later in this tutorial, you will also need to check the state for equality and
return a copy of the state, so you also derive the trait implementation for
<code class="docutils literal notranslate"><span class="pre">PartialEq</span></code>, <code class="docutils literal notranslate"><span class="pre">Eq</span></code>, <code class="docutils literal notranslate"><span class="pre">Clone</span></code>, and <code class="docutils literal notranslate"><span class="pre">Copy</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[derive(Serialize, PartialEq, Eq, Debug, Clone, Copy)]</span>
<span class="k">enum</span><span class="w"> </span><span class="nc">PiggyBankState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Intact</span><span class="p">,</span>
<span class="w">    </span><span class="n">Smashed</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="s" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>In certain cases, the <code class="docutils literal notranslate"><span class="pre">Serial</span></code> and <code class="docutils literal notranslate"><span class="pre">DeserialWithState</span></code>
traits are needed instead of <code class="docutils literal notranslate"><span class="pre">Serialize</span></code>. See
<a class="reference internal" href="../../docs/smart-contracts/develop-contracts.html#serialize-state-and-parameters"><span class="std std-ref">Serializable state and parameters</span></a> for more information.</p>
</aside>
</aside>
</section>
<section id="set-up-a-piggy-bank">
<h2>Set up a piggy bank<a class="headerlink" href="#set-up-a-piggy-bank" title="Link to this heading">#</a></h2>
<p>Now you will write the function to set up a new piggy bank, which in turn means
specifying the init function for a smart contract.
A smart contract must specify an init function, which is called when new
instances of the contract are created, and is used to set up the initial state of
the contract instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <a class="reference external" href="https://www.rust-lang.org/">Rust</a> developer could compare init functions with the convention of
having a <code class="docutils literal notranslate"><span class="pre">new</span></code> function for types, and the smart contract as the type.</p>
<p>If you have experience with object-oriented programming, it might help to
think of a smart contract as a <em>class</em>, the init function as a
<em>constructor</em>, and smart contract instances as <em>objects</em>.</p>
</div>
<p>In the case of the piggy bank; the initial state should be set to <code class="docutils literal notranslate"><span class="pre">Intact</span></code>.</p>
<section id="the-init-macro">
<h3>The <code class="docutils literal notranslate"><span class="pre">#[init]</span></code> macro<a class="headerlink" href="#the-init-macro" title="Link to this heading">#</a></h3>
<p>In <a class="reference external" href="https://www.rust-lang.org/">Rust</a> an init function can be specified as a regular function that is annotated
with a procedural macro from <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code> called <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a>.
This allows you to create a new piggy bank as follows:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[init(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_init</span><span class="p">(</span>
<span class="w">    </span><span class="n">_ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">InitContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">_state_builder</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">StateBuilder</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">InitResult</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The macro saves you the details of setting up the function as an external
function and serializing the state to bytes. The macro also provides an interface for
accessing information about the context of the smart-contract call.</p>
<p>The init function requires a name for the smart contract, in this case
<code class="docutils literal notranslate"><span class="pre">&quot;PiggyBank&quot;</span></code>. The name <a class="footnote-reference brackets" href="#valid-name" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> is used as part of the exported
function, and is how you distinguish this smart contract from other smart
contracts in your module.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[init(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">)]</span>
</pre></div>
</div>
<p>The init function takes two arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ctx:</span> <span class="pre">&amp;InitContext</span></code>, which is a struct with a number of
getter functions for accessing information about the current context, such as
the account that invoked this contract, the supplied arguments, and information about the state of the blockchain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state_builder:</span> <span class="pre">&amp;mut</span> <span class="pre">StateBuilder</span></code>, which has functions for creating
sets, maps, and boxes that effectively utilize the way contract state is
stored on the chain.</p></li>
</ul>
<p>The return type of the function is <code class="docutils literal notranslate"><span class="pre">InitResult&lt;PiggyBankState&gt;</span></code>, which is an
alias for <code class="docutils literal notranslate"><span class="pre">Result&lt;PiggyBankState,</span> <span class="pre">Reject&gt;</span></code>. The returned state is serialized
and set as the initial state of the smart contract.</p>
<p>Initializing the piggy bank state to be <code class="docutils literal notranslate"><span class="pre">Intact</span></code> is then straightforward:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="nb">Ok</span><span class="p">(</span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">)</span>
</pre></div>
</div>
<p>A more complex smart contract would take a parameter and check during
initialization that everything is set up as expected. This will be described later.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="valid-name" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>The <strong>contract name</strong> is only allowed to consist of ASCII alphanumeric or
punctuation characters, and is not allowed to contain the <code class="docutils literal notranslate"><span class="pre">.</span></code> symbol. The <strong>function name</strong> is only allowed to consist of ASCII alphanumeric or punctuation characters. The <strong>function name</strong> together with <strong>contract name</strong> must not exceed 99 characters.</p>
</aside>
</aside>
</section>
</section>
<section id="define-interaction-with-piggy-banks">
<h2>Define interaction with piggy banks<a class="headerlink" href="#define-interaction-with-piggy-banks" title="Link to this heading">#</a></h2>
<p>You have now defined how instances of your smart contract are created, and the
smart contract is in principle a valid contract.
However, you would also like to define how to interact with instances of your
contract, specifically how to add CCD to it and how to smash a piggy bank.</p>
<p>A smart contract can expose zero or more functions for interacting with an
instance.
These functions are called receive functions.
They can access the state of the instance and the blockchain and perform
actions, such as transferring CCD to an account or invoking another contract instance.
Receive functions are immutable/readonly by default, which means that they
cannot mutate the state.
You will look at mutable receive methods when it’s time to implement smashing the piggy bank.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a <a class="reference external" href="https://www.rust-lang.org/">Rust</a> developer, receive functions are like methods with
a reference to <cite>self</cite>. The reference is immutable by default, and mutable for
mutable receive functions.</p>
<p>A continuation of the analogy to object-oriented programming:
receive functions correspond to object methods.</p>
</div>
<section id="the-receive-macro">
<h3>The <code class="docutils literal notranslate"><span class="pre">#[receive(...)]</span></code> macro<a class="headerlink" href="#the-receive-macro" title="Link to this heading">#</a></h3>
<p>In Rust, receive functions can be specified using the procedural macro
<a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.receive.html"><code class="docutils literal notranslate"><span class="pre">#[receive]</span></code></a>, which, like <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a>, is used to annotate a function and sets up an
external function and supplies you with an interface for accessing the context.
But, unlike the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a> macro, the function for <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.receive.html"><code class="docutils literal notranslate"><span class="pre">#[receive]</span></code></a> is supplied with
a reference to the host (through which you can access the state of the instance):</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;MyContract&quot;</span><span class="cp">, name = </span><span class="s">&quot;some_interaction&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">some_receive</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">MyState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="n">MyReturnValue</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">todo!</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">contract</span></code> attribute supplies the name of the contract to the macro.
This name should match the name in the corresponding attribute in <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a>
(<code class="docutils literal notranslate"><span class="pre">&quot;PiggyBank&quot;</span></code> in our case). It also requires a name to identify this
particular receive function using <code class="docutils literal notranslate"><span class="pre">name</span></code>. The name and contract attributes
each have to be unique within a smart contract module.</p>
<p>The return type of the function is <code class="docutils literal notranslate"><span class="pre">ReceiveResult&lt;MyReturnValue&gt;</span></code>, which is an alias for
<code class="docutils literal notranslate"><span class="pre">Result&lt;MyReturnValue,</span> <span class="pre">Reject&gt;</span></code>.
You will learn more about return values when implementing a view function for
the piggy bank.</p>
</section>
<section id="inserting-ccd">
<h3>Inserting CCD<a class="headerlink" href="#inserting-ccd" title="Link to this heading">#</a></h3>
<p>The first interaction you will specify for your piggy bank is how to insert CCD into it.
You start by defining a receive function as:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;insert&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_insert</span><span class="p">(</span>
<span class="w">    </span><span class="n">_ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">todo!</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Make sure that the contract name matches the one you use for the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.init.html"><code class="docutils literal notranslate"><span class="pre">#[init]</span></code></a> macro,
and name the receive function <code class="docutils literal notranslate"><span class="pre">insert</span></code>.
The function will not need to use the <code class="docutils literal notranslate"><span class="pre">ctx</span></code> context, so by convention, you
prefix the argument with <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p>
<p>In the function body you have to make sure that the piggy bank is still intact: the
smart contract should reject any messages if the piggy bank is smashed:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Smashed</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="n">Reject</span><span class="p">::</span><span class="n">default</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since returning early is a common pattern when writing smart contracts, and in
<a class="reference external" href="https://www.rust-lang.org/">Rust</a> in general, <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code> exposes a <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/macro.bail.html"><code class="docutils literal notranslate"><span class="pre">bail!</span></code></a> macro:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Smashed</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">bail</span><span class="o">!</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Furthermore, you can use the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/macro.ensure.html"><code class="docutils literal notranslate"><span class="pre">ensure!</span></code></a> macro for returning early depending on a condition:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>
</pre></div>
</div>
<p>From this line, you will know that the state of the piggy bank is intact and all
you have left to do is accept the incoming amount of CCD.
The CCD balance is maintained by the blockchain, so there is no need for you to
maintain this in your contract. The contract just needs to produce an empty return value:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="nb">Ok</span><span class="p">(())</span>
</pre></div>
</div>
<p>So far you have the following definition of the receive function:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;insert&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_insert</span><span class="p">(</span>
<span class="w">    </span><span class="n">_ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The definition of how to add CCD to the piggy bank is almost done, but one important detail is
missing.
If you were to send CCD to the current smart contract, the transaction
would be rejected. This is a safety feature of <code class="docutils literal notranslate"><span class="pre">concordium-std</span></code>,
which, by default, prevents init and receive functions
from accepting CCD.</p>
<p>The reason for rejecting CCD by default is to reduce the risk of creating a smart
contract that accepts CCD without the ability to retrieve it again; any CCD passed to such a contract
would be <em>inaccessible forever</em>.</p>
<p>To be able to accept CCD, you have to add the <code class="docutils literal notranslate"><span class="pre">payable</span></code> attribute to the <code class="docutils literal notranslate"><span class="pre">#[receive]</span></code> macro.
Now the function is required to
take an extra argument <code class="docutils literal notranslate"><span class="pre">amount:</span> <span class="pre">Amount</span></code>, which represents the amount that is passed to the receive
function.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;insert&quot;</span><span class="cp">, payable)]</span>
</span><span class="k">fn</span><span class="w"> </span><span class="nf">piggy_insert</span><span class="p">(</span>
<span class="w">    </span><span class="n">_ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="n">_amount</span><span class="p">:</span><span class="w"> </span><span class="nc">Amount</span><span class="p">,</span>
</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As mentioned above, since the blockchain is maintaining the balance of our smart contract, you
do not have to do that yourself, and the <code class="docutils literal notranslate"><span class="pre">amount</span></code> is not used by your contract.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">payable</span></code> attribute also exists for the <code class="docutils literal notranslate"><span class="pre">#[init]</span></code> macro.</p>
</div>
</section>
<section id="smashing-a-piggy-bank">
<span id="smashing-the-piggy-bank-writing"></span><h3>Smashing a piggy bank<a class="headerlink" href="#smashing-a-piggy-bank" title="Link to this heading">#</a></h3>
<p>Now that you can insert CCD into a piggy bank, you also need to define how to
smash one.
Remember, you only want the owner of the piggy bank (smart contract
instance) to be able to smash it and only if it isn’t already smashed.
It should set its state to be smashed and transfer all of its CCD to the owner.</p>
<p>Again you use the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.receive.html"><code class="docutils literal notranslate"><span class="pre">#[receive]</span></code></a> macro to define the smash function:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;smash&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_smash</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">todo!</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ensure that the contract name matches the one of your smart contract and name this function <code class="docutils literal notranslate"><span class="pre">smash</span></code>.</p>
<p>To access the contract owner, use a getter function exposed by the context
<code class="docutils literal notranslate"><span class="pre">ctx</span></code>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">();</span>
</pre></div>
</div>
<p>This returns the account address of the contract instance owner, i.e. the
account that created the smart contract instance by invoking the
init function.</p>
<p>Similarly, the context has a getter function to access the sender of the current
message that triggered this receive function:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">();</span>
</pre></div>
</div>
<p>Since both accounts and smart-contract instances are capable of sending messages,
<code class="docutils literal notranslate"><span class="pre">sender</span></code> is of the  <code class="docutils literal notranslate"><span class="pre">Address</span></code> type, which is either an account
address or a contract instance address.</p>
<p>To compare the <code class="docutils literal notranslate"><span class="pre">sender</span></code> with <code class="docutils literal notranslate"><span class="pre">owner</span></code> you can use the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/enum.Address.html#method.matches_account"><code class="docutils literal notranslate"><span class="pre">matches_account</span></code></a>
function defined on the <code class="docutils literal notranslate"><span class="pre">sender</span></code>, which will only return true if the sender is
an account address that is equal to the owner:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">sender</span><span class="p">.</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">));</span>
</pre></div>
</div>
<p>Next, ensure that the state of the piggy bank is <code class="docutils literal notranslate"><span class="pre">Intact</span></code>, just like previously:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>
</pre></div>
</div>
<p>At this point you know the piggy bank is still intact and the sender is the
owner, meaning you now get to the smashing part.
But there is one problem.
The state is immutable, so you first need to make the receive function mutable by
adding the <a class="reference external" href="https://docs.rs/concordium-std-derive/latest/concordium_std_derive/attr.receive.html#mutable-function-can-mutate-the-state"><code class="docutils literal notranslate"><span class="pre">mutable</span></code></a> attribute to the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/attr.receive.html"><code class="docutils literal notranslate"><span class="pre">#[receive]</span></code></a> macro.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;smash&quot;</span><span class="cp">, mutable)]</span>
</span><span class="k">fn</span><span class="w"> </span><span class="nf">piggy_smash</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">();</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">sender</span><span class="p">.</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">));</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>

<span class="w">    </span><span class="fm">todo!</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This gives you a mutable reference to the <code class="docutils literal notranslate"><span class="pre">host</span></code>, through which you can access
the mutable state with the <code class="docutils literal notranslate"><span class="pre">state_mut</span></code> function. You then set the state to
<code class="docutils literal notranslate"><span class="pre">Smashed</span></code>, preventing further insertions of CCD:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state_mut</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Smashed</span><span class="p">;</span>
</pre></div>
</div>
<p>Lastly, you need to empty the piggy bank. To do that, transfer all the CCD
of the smart-contract instance to an account.</p>
<p>To transfer CCD from a smart contract instance you use the <a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/struct.ExternHost.html#tymethod.invoke_transfer"><code class="docutils literal notranslate"><span class="pre">invoke_transfer</span></code></a>
method on the <code class="docutils literal notranslate"><span class="pre">host</span></code>. For this, you need to provide the address of the receiving
account and the amount to transfer.
In this case the receiver is the owner of the piggy bank and the amount is the
entire balance of the piggy bank.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">host</span></code> has a getter function for reading
the current balance of the smart contract instance, which is called
<a class="reference external" href="https://docs.rs/concordium-std/latest/concordium_std/struct.ExternHost.html#tymethod.self_balance"><code class="docutils literal notranslate"><span class="pre">self_balance</span></code></a>:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host</span><span class="p">.</span><span class="n">self_balance</span><span class="p">();</span>
</pre></div>
</div>
<p>You already have a variable with the address of the contract owner, so you can
use that to invoke the transfer:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="nb">Ok</span><span class="p">(</span><span class="n">host</span><span class="p">.</span><span class="n">invoke_transfer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">)</span><span class="o">?</span><span class="p">)</span>
</pre></div>
</div>
<p>A transfer can fail in two ways, either your contract has insufficient funds, or
the receiver account does not exist. Neither can occur in this contract. This is
because it tries to transfer its own balance, and because a contract always has
a valid owner. The code propagates the error out with the <code class="docutils literal notranslate"><span class="pre">?</span></code>, which will
become useful when testing the contract.</p>
<p>The final definition of the “smash” receive function is then:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;smash&quot;</span><span class="cp">, mutable)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_smash</span><span class="p">(</span>
<span class="w">    </span><span class="n">ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">();</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">sender</span><span class="p">.</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">));</span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Intact</span><span class="p">);</span>

<span class="w">    </span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state_mut</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PiggyBankState</span><span class="p">::</span><span class="n">Smashed</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host</span><span class="p">.</span><span class="n">self_balance</span><span class="p">();</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">host</span><span class="p">.</span><span class="n">invoke_transfer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">owner</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">)</span><span class="o">?</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="viewing-the-state">
<h3>Viewing the state<a class="headerlink" href="#viewing-the-state" title="Link to this heading">#</a></h3>
<p>Now that you can smash and insert CCD into a piggy bank, you can add a way to
check the current state and balance of the piggy bank.
This is what the return values of receive methods are for:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(contract = </span><span class="s">&quot;PiggyBank&quot;</span><span class="cp">, name = </span><span class="s">&quot;view&quot;</span><span class="cp">)]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">piggy_view</span><span class="p">(</span>
<span class="w">    </span><span class="n">_ctx</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span>
<span class="w">    </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Host</span><span class="o">&lt;</span><span class="n">PiggyBankState</span><span class="o">&gt;</span><span class="p">,</span>
<span class="hll"><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="p">(</span><span class="n">PiggyBankState</span><span class="p">,</span><span class="w"> </span><span class="n">Amount</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">current_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">current_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host</span><span class="p">.</span><span class="n">self_balance</span><span class="p">();</span>
<span class="hll"><span class="w">    </span><span class="nb">Ok</span><span class="p">((</span><span class="n">current_state</span><span class="p">,</span><span class="w"> </span><span class="n">current_balance</span><span class="p">))</span>
</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">piggy_view</span></code> method gets a copy of the state and the balance and returns
it as a tuple of type <code class="docutils literal notranslate"><span class="pre">(PiggyBankState,</span> <span class="pre">Amount)</span></code>, which is also specified in
the return type.</p>
<p>A more complex smart contract might have multiple view functions that return
different parts of the state or return a value computed from the state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To view return values of a contract instance on the chain, see the guide <a class="reference internal" href="../../docs/smart-contracts/guides/invoke-instance.html#invoke-instance"><span class="std std-ref">Invoke</span></a>.</p>
</div>
<p id="cargo-concordium-build">You now have all the parts for your piggy bank smart contract. Before you start testing it, check that it builds by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span>cargo<span class="w"> </span>concordium<span class="w"> </span>build
</pre></div>
</div>
<p>This should succeed if everything is set up correctly. Otherwise, compare your
code with the one found <a class="reference external" href="https://github.com/Concordium/concordium-rust-smart-contracts/blob/main/examples/piggy-bank/part1/src/lib.rs">here</a>.</p>
<p>To continue with the tutorial click <a class="reference internal" href="testing.html#piggy-bank-testing"><span class="std std-ref">here</span></a>.</p>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><style>
  legend {
    font-size: 12px;
    font-weight:bold ;
  }

  label {
    font-size: 12px;
  }
</style>

<fieldset>
  <legend>Was this article helpful?</legend>
  <input type="radio" id="Yes" name="rating" value="Yes" onclick="_paq.push(['trackEvent', 'Rating', 'ClickYes', 'Yes']);">
  <label for="Yes">Yes</label>
  <input type="radio" id="No" name="rating" value="No" onclick="_paq.push(['trackEvent', 'Rating', 'ClickNo', 'No']);">
  <label for="No">No</label>
</fieldset>

<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  (function() {
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='https://cdn.matomo.cloud/concordium.matomo.cloud/container_8ZIoCz8b.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Tag Manager --></div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The piggy bank smart contract</p>
      </div>
    </a>
    <a class="right-next"
       href="testing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Testing the piggy bank smart contract</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bring-in-the-standard-library">Bring in the standard library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#piggy-bank-contract">Piggy bank contract</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-the-state">Specifying the state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-a-piggy-bank">Set up a piggy bank</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-init-macro">The <code class="docutils literal notranslate"><span class="pre">#[init]</span></code> macro</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-interaction-with-piggy-banks">Define interaction with piggy banks</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-receive-macro">The <code class="docutils literal notranslate"><span class="pre">#[receive(...)]</span></code> macro</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inserting-ccd">Inserting CCD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smashing-a-piggy-bank">Smashing a piggy bank</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-the-state">Viewing the state</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/Concordium/concordium.github.io/edit/main/source/mainnet/tutorials/piggy-bank/writing.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  

  <p class="copyright">
    
      © Copyright 2021 - 2025, Concordium Software ApS.
      <br/>
    
  </p>

  <style>
    .cc {
      position: relative;
      bottom: 0%;
      left: 0%;
    }

    .cc a {
      display: inline-block;
      text-align: left;
      padding-left: 16px;
      padding-bottom: 8px;
      color: black;
      font-size: 8px;
    }
</style>

<div class="cc">
  <a text-decoration=none href="http://creativecommons.org/licenses/by-sa/4.0/">
    <img src="../../_static/cc-sa-by.png" />
  </a>
  <a text-decoration=none href="../../net/guides/legal.html" >
    Legal information
  </a>
</div>
  <div id="cookie-consent" class="consent">
    <p>This website only aggregates and analyzes the actions you take here if you allow cookies. If you do not allow cookies, it protects your privacy, but also prevents the owner from learning from your actions and creating a better experience for you and other users.</p><p>Note that if you opt in and you clear your cookies, delete the opt-in cookie, or if you change computers or Web browsers, you will need to perform the opt-in procedure again.</p>
    <button onclick="consentGranted()">Allow</button>
    <button onclick="consentDenied()">Decline</button>
    <a href="https://concordium.com/privacy-policy/">Privacy policy</a>
</div>

<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];

// Save the choice in a cookie
function storeChoice(granted) {
  document.cookie = "cookie-consent=" + granted
}

// Look for a cookie storing the previous choice of the user.
// Returns undefined if no choice was stored, otherwise a boolean for whether the
// user gave consent.
function loadChoice() {
  if (!document.cookie.includes("cookie-consent=")) {
      return undefined;
  }
  return document.cookie.includes("cookie-consent=true")
}

// Removes the cookie consent banner
function removeCookieConsentBanner() {
  document.getElementById("cookie-consent").remove()
}

// Called by the cookie consent banner if granted permission
function consentGranted() {
  storeChoice(true)
  _paq.push(['setCookieConsentGiven']);
  removeCookieConsentBanner()
}

// Called by the cookie consent banner if denied permission
function consentDenied() {
  storeChoice(true)
  removeCookieConsentBanner()
}

const stored = loadChoice();
if (stored) {
 consentGranted()
}

_paq.push(['requireCookieConsent']);
/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);

(function() {
    var u="https://concordium.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/concordium.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();

  // remember tracking consent was given for all subsequent page views and visits
_paq.push(['rememberCookieConsentGiven']);

</script>


<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4771748.js"></script>
<!-- End of HubSpot Embed Code -->

  </body>
</html>