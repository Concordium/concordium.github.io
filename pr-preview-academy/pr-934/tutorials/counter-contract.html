


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Concordium counter smart contract &#8212; Concordium  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tippy.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <link rel="shortcut icon" href="../_static/concordium-logo-no-text.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Register Data On-Chain" href="register-data.html" />
    <link rel="prev" title="Beginner level tutorials and assignment" href="../beg-tutorials.html" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    <style>
.navbar-brand img {
    max-height: 200px;
    width: auto;
}
</style>

<div>
    <a href="https://academy.concordium.software/">
        <img class="logo" src="../_static/concordium-logo-dark.svg" />
    </a>
</div>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <style>
  body {margin:0;}
  
  .navbar-menu {
    position: relative;
    margin-left: 190px;
    background: none;
  }
  
  .navbar-light {
      background: #ededed!important;
      box-shadow: none;
  }
  
  .navbar-menu a {
    float: left;
    display: inline;
    text-align: center;
    color: var(--font-color);
    font-size: 15px;
    font-family: 'IBM Plex Sans', 'Helvetica Neue', Arial, sans-serif;
  }
  
  /* Dropdown Button */
  .dropbtn {
    background: none;
    color: black;
    font-size: 16px;
    font-weight: 600;
    padding-left: 20px;
    padding-right: 20px;
    border: none;
    font-family: inherit; /* Important for vertical align on mobile phones */
    margin: 0; /* Important for vertical align on mobile phones */
  }
  
  /* The dropdown container */
  .dropdown {
      float: left;
    }
  
    /* Dropdown content (hidden by default) */
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
    }
  
    /* Links inside the dropdown */
    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      text-align: left;
    }
  
    /* Show the dropdown menu on hover */
    .dropdown:hover .dropdown-content {
      display: block;
    }
  
  /* Large devices (laptops/desktops, 992px to 768px ) */
  @media only screen and (max-width: 1178px) {
    .navbar-menu {
      display: none;}
  
  }
  </style>
<div class="navbar-menu w3-hide-medium w3-hide-small">
  <div class="dropdown">
    <button class="dropbtn"><a href="../intro.html">Introduction</a></button>
    <div class="dropdown-content">
      
    </div>
  </div>
  <div class="dropdown">
    <button class="dropbtn"><a href="../beg-tutorials.html">Beginner</a></button>
  </div>
  <div class="dropdown">
    <button class="dropbtn"><a href="../mid-tutorials.html">Intermediate</a></button>
  </div>
  <div class="dropdown">
    <button class="dropbtn"><a href="../adv-tutorials.html">Advanced</a></button>
  </div>
  <div class="dropdown">
    <button class="dropbtn"><a href="https://docs.google.com/forms/d/1ks_oWIxbRoW6NGHHjwOGfaO4pVvZAD92me0ChbvzDZc/edit">Claim badge</a></button>
  </div>
  </div>
</div>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/Concordium" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="mailto:support@concordium.software" rel="noopener" target="_blank" title="Support"><span><i class="fas fa-envelope"></i></span>
            <label class="sr-only">Support</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://developer.concordium.software/en/mainnet/net/guides/developer-page.html#block-explorers" rel="noopener" target="_blank" title="Monitor"><span><i class="fas fa-chart-line"></i></span>
            <label class="sr-only">Monitor</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://support.concordium.software/latest" rel="noopener" target="_blank" title="Discourse"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCPZc2CuB2jGbZjD_5zX7-1A" rel="noopener" target="_blank" title="YouTube"><span><i class="fab fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://medium.com/concordium" rel="noopener" target="_blank" title="Medium"><span><i class="fab fa-medium"></i></span>
            <label class="sr-only">Medium</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://developer.concordium.software/en/mainnet/index.html" rel="noopener" target="_blank" title="Documentation"><span><i class="fas fa-book"></i></span>
            <label class="sr-only">Documentation</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../setup-env.html">
   Setup the development environment
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Concordium counter smart contract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="register-data.html">
   Register Data On-Chain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple-nft-dapp.html">
   Simple minting dApp
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignment-1/basic-smart-contract.html">
   Assignment 1: Basic smart contract
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#increment-and-decrement-counter">
   Increment and decrement counter
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increment-counter">
     Increment counter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decrement-counter">
     Decrement counter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#view-function">
     View function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-deploy-and-initialize-the-contract">
   Build, deploy, and initialize the contract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interact-with-the-contract">
   Interact with the contract
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     View function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increment-function">
     Increment function
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/Concordium/concordium.github.io/edit/main/source/academy/tutorials/counter-contract.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="concordium-counter-smart-contract">
<span id="counter-sc"></span><h1>Concordium counter smart contract<a class="headerlink" href="#concordium-counter-smart-contract" title="Permalink to this headline">#</a></h1>
<p>This tutorial guides you through creating a smart contract using the Concordium a default contract template that simply keeps a counter value in its state. It is a super simple, fundamental example contract that touches on the following points:</p>
<ul class="simple">
<li><p>to be able to increase/decrease the counter value by the parameter given by the user if it is a positive number</p></li>
<li><p>view the current value</p></li>
<li><p>return a custom error when someone tries to increase it with a negative value (or vice versa)</p></li>
<li><p>all these operations have to be done by only the owner of the contract.</p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Before starting the next steps, make sure that you have <a class="reference internal" href="../setup-env.html#setup-env"><span class="std std-ref">setup the developer environment</span></a> with the tools needed.</p>
</div>
<p>Once you have set up the tools needed you are ready to create your smart contract project. First, create a working directory, and run the command below in that directory. It will set up the initial project for you, including necessary rust dependencies.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The template repository contains <a class="reference external" href="https://github.com/Concordium/concordium-rust-smart-contracts/tree/main/templates">short GIFs</a> that show many of these commands.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cargo concordium init</span>
</pre></div>
</div>
<p>Select the <code class="docutils literal notranslate"><span class="pre">Default</span></code> option from the menu.</p>
<a class="reference internal image-reference" href="../_images/select-default.png"><img alt="../_images/select-default.png" src="../_images/select-default.png" style="width: 100%;" /></a>
<p>Then it will ask for a name and a description of your project. Fill them in.
The result is a basic skeleton of a smart contract.
Initially, it has a <code class="docutils literal notranslate"><span class="pre">State</span></code> struct, an <code class="docutils literal notranslate"><span class="pre">init</span></code> function for creating new instances, an <code class="docutils literal notranslate"><span class="pre">Error</span></code> enum for custom errors, a <code class="docutils literal notranslate"><span class="pre">view</span></code> function, and a <code class="docutils literal notranslate"><span class="pre">receive</span></code> function.</p>
<a class="reference internal image-reference" href="../_images/contract.png"><img alt="../_images/contract.png" src="../_images/contract.png" style="width: 100%;" /></a>
<p>Add the counter to the state and i8 for integer. Then add the values <code class="docutils literal notranslate"><span class="pre">OwnerError</span></code>, <code class="docutils literal notranslate"><span class="pre">IncrementError</span></code>, and <code class="docutils literal notranslate"><span class="pre">DecrementError</span></code> to the <code class="docutils literal notranslate"><span class="pre">Error</span></code> enum, and specify the counter initial value as zero in the <code class="docutils literal notranslate"><span class="pre">init</span></code> function so the counter value starts from 0 when you create a new, fresh instance the contract. Your contract now looks like the example below.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// Your smart contract state.</span>
<span class="cp">#[derive(Serialize, SchemaType, Clone)]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">State</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Your state</span>
<span class="w">    </span><span class="n">counter</span>: <span class="kt">i8</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="sd">/// Your smart contract errors.</span>
<span class="cp">#[derive(Debug, PartialEq, Eq, Reject, Serial, SchemaType)]</span><span class="w"></span>
<span class="k">enum</span> <span class="nc">Error</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="sd">/// Failed parsing the parameter.</span>
<span class="w">    </span><span class="cp">#[from(ParseError)]</span><span class="w"></span>
<span class="w">    </span><span class="n">ParseParamsError</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="sd">/// Your error</span>
<span class="w">    </span><span class="n">OwnerError</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IncrementError</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">DecrementError</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="sd">/// Init function that creates a new smart contract.</span>
<span class="cp">#[init(contract = </span><span class="s">&quot;counter&quot;</span><span class="cp">)]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">init</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">_ctx</span>: <span class="kp">&amp;</span><span class="nc">InitContext</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">_state_builder</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">StateBuilder</span><span class="p">,</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">InitResult</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Your code</span>

<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">State</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">counter</span>: <span class="mi">0</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="increment-and-decrement-counter">
<h2>Increment and decrement counter<a class="headerlink" href="#increment-and-decrement-counter" title="Permalink to this headline">#</a></h2>
<div class="section" id="increment-counter">
<h3>Increment counter<a class="headerlink" href="#increment-counter" title="Permalink to this headline">#</a></h3>
<p>Then change the update function as described below. Remember that input needs to be parsed without any errors. The value must be positive, otherwise you will get an <code class="docutils literal notranslate"><span class="pre">Error::IncrementError</span></code>. The transaction must be triggered by the owner of the contract instance or it will throw <code class="docutils literal notranslate"><span class="pre">Error::OwnerError</span></code>. And the function itself has to be a mutable function because you are going to change the state of the contract.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="nc">IncrementVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">i8</span><span class="p">;</span><span class="w"></span>
<span class="sd">/// Receive function. The input parameter is the `IncrementVal`.</span>
<span class="sd">///  If the account owner does not match the contract owner, the receive function will throw [`Error::OwnerError`].</span>
<span class="sd">///  If the number to increment by is not positive or is zero, the receive function will throw [`Error::IncrementError`].</span>
<span class="cp">#[receive(</span>
<span class="cp">    contract = </span><span class="s">&quot;counter&quot;</span><span class="cp">,</span>
<span class="cp">    name = </span><span class="s">&quot;increment&quot;</span><span class="cp">,</span>
<span class="cp">    parameter = </span><span class="s">&quot;IncrementVal&quot;</span><span class="cp">,</span>
<span class="cp">    error = </span><span class="s">&quot;Error&quot;</span><span class="cp">,</span>
<span class="cp">    mutable</span>
<span class="cp">)]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">increment</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Host</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Your code</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">param</span>: <span class="nc">IncrementVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">parameter_cursor</span><span class="p">().</span><span class="n">get</span><span class="p">()</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host</span><span class="p">.</span><span class="n">state_mut</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">().</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="n">Error</span>::<span class="n">OwnerError</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span>::<span class="n">IncrementError</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">state</span><span class="p">.</span><span class="n">counter</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">param</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="decrement-counter">
<h3>Decrement counter<a class="headerlink" href="#decrement-counter" title="Permalink to this headline">#</a></h3>
<p>Add a new mutable function to implement decrement with a similar approach. It will also take an input parameter, but this time make sure that it is negative because a violation will be caused by an <code class="docutils literal notranslate"><span class="pre">Error::DecrementError</span></code>. Like the other one, this can be triggered by only the owner of the contract,otherwise it will throw an <code class="docutils literal notranslate"><span class="pre">Error::OwnerError</span></code>.</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="cp">#[receive(</span>
<span class="cp">    contract = </span><span class="s">&quot;counter&quot;</span><span class="cp">,</span>
<span class="cp">    name = </span><span class="s">&quot;decrement&quot;</span><span class="cp">,</span>
<span class="cp">    parameter = </span><span class="s">&quot;IncrementVal&quot;</span><span class="cp">,</span>
<span class="cp">    error = </span><span class="s">&quot;Error&quot;</span><span class="cp">,</span>
<span class="cp">    mutable</span>
<span class="cp">)]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">decrement</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">ReceiveContext</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Host</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Your code</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">param</span>: <span class="nc">IncrementVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">parameter_cursor</span><span class="p">().</span><span class="n">get</span><span class="p">()</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">host</span><span class="p">.</span><span class="n">state_mut</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ctx</span><span class="p">.</span><span class="n">sender</span><span class="p">().</span><span class="n">matches_account</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">.</span><span class="n">owner</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="n">Error</span>::<span class="n">OwnerError</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ensure</span><span class="o">!</span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span>::<span class="n">DecrementError</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">state</span><span class="p">.</span><span class="n">counter</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">param</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="view-function">
<h3>View function<a class="headerlink" href="#view-function" title="Permalink to this headline">#</a></h3>
<p>The view function will return only the counters value so you need to update its return value as i8 and return it from the host.state().</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="sd">/// View function that returns the content of the state.</span>
<span class="cp">#[receive(contract = </span><span class="s">&quot;counter&quot;</span><span class="cp">, name = </span><span class="s">&quot;view&quot;</span><span class="cp">, return_value = </span><span class="s">&quot;i8&quot;</span><span class="cp">)]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">view</span><span class="o">&lt;&#39;</span><span class="na">a</span><span class="p">,</span><span class="w"> </span><span class="o">&#39;</span><span class="na">b</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">_ctx</span>: <span class="kp">&amp;</span><span class="o">&#39;</span><span class="na">a</span> <span class="nc">ReceiveContext</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span>: <span class="kp">&amp;</span><span class="o">&#39;</span><span class="na">b</span> <span class="nc">Host</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">ReceiveResult</span><span class="o">&lt;</span><span class="kt">i8</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">host</span><span class="p">.</span><span class="n">state</span><span class="p">().</span><span class="n">counter</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-deploy-and-initialize-the-contract">
<h2>Build, deploy, and initialize the contract<a class="headerlink" href="#build-deploy-and-initialize-the-contract" title="Permalink to this headline">#</a></h2>
<p>Create a <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder to keep the schema output file and Wasm compiled contract in and run the build command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cargo concordium build --out dist/module.wasm.v1 --schema-out dist/schema.bin</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/build.png"><img alt="../_images/build.png" src="../_images/build.png" style="width: 100%;" /></a>
<p>Deploy it with the command below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">concordium-client module deploy dist/module.wasm.v1 --sender &lt;YOUR-ACCOUNT&gt; --name counter --grpc-port 20001</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/deploy.png"><img alt="../_images/deploy.png" src="../_images/deploy.png" style="width: 100%;" /></a>
<p>Initialize it to create your contract instance, so you are ready to invoke the functions in the next section.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">concordium-client contract init &lt;YOUR-MODULE-HASH&gt; --sender &lt;YOUR-ADDRESS&gt; --energy 30000 --contract counter --grpc-port 20001</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/initialize.png"><img alt="../_images/initialize.png" src="../_images/initialize.png" style="width: 100%;" /></a>
</div>
<div class="section" id="interact-with-the-contract">
<h2>Interact with the contract<a class="headerlink" href="#interact-with-the-contract" title="Permalink to this headline">#</a></h2>
<div class="section" id="id1">
<h3>View function<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>First, check the initial state of the contract.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">concordium-client contract invoke &lt;YOUR-CONTRACT-INSTANCE&gt; --entrypoint view --schema dist/schema.bin --grpc-port 20001</span>
</pre></div>
</div>
<p>Since you just initialized the contract it is 0.</p>
<a class="reference internal image-reference" href="../_images/invoke.png"><img alt="../_images/invoke.png" src="../_images/invoke.png" style="width: 100%;" /></a>
</div>
<div class="section" id="increment-function">
<h3>Increment function<a class="headerlink" href="#increment-function" title="Permalink to this headline">#</a></h3>
<p>Create a JSON file that holds your operator that will be given as input to the function and run the command below. Basically, you are saying to the contract instance “with this transaction I will update your state from the increment entrypoint” which is your function name with this parameter.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">concordium-client contract update &lt;YOUR-CONTRACT-INSTANCE&gt; --entrypoint increment --parameter-json &lt;PATH-TO-JSON&gt; --schema dist/smart-contract-multi/schema.bin --sender &lt;YOUR-ADDRESS&gt; --energy 6000 --grpc-port 20001</span>
</pre></div>
</div>
<p>Start by testing with your conditions. First, try another account other than the owner of the contract since you want that only the owner can call this function.</p>
<a class="reference internal image-reference" href="../_images/owner-error.png"><img alt="../_images/owner-error.png" src="../_images/owner-error.png" style="width: 100%;" /></a>
<p>You get error code: -2. Check the developer portal of Concordium for information about <a class="reference internal" href="../custom-errors.html#custom-errors"><span class="std std-ref">custom errors</span></a>. Basically, -2 means you are calling the second error code from your Error enum, which is OwnerError. So that means you have fulfilled the requirement that only the owner can call these functions. Update the state with number 2 now.</p>
<a class="reference internal image-reference" href="../_images/owner-error-ok.png"><img alt="../_images/owner-error-ok.png" src="../_images/owner-error-ok.png" style="width: 100%;" /></a>
<p>Now check the state once more.</p>
<a class="reference internal image-reference" href="../_images/invoke2.png"><img alt="../_images/invoke2.png" src="../_images/invoke2.png" style="width: 100%;" /></a>
<p>Unsurprisingly, the state is 2. Now check the other requirement: that you cannot increment it with a negative number. Change the value in the JSON file to a negative number like -2.</p>
<a class="reference internal image-reference" href="../_images/increment-neg-error.png"><img alt="../_images/increment-neg-error.png" src="../_images/increment-neg-error.png" style="width: 100%;" /></a>
<p>You cannot do it because of error code -3 which is the third element in the enum: <code class="docutils literal notranslate"><span class="pre">IncrementError</span></code>. That means the increment method operates as expected in your contract.</p>
<p>You can play with decrement in the same way.</p>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../beg-tutorials.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Beginner level tutorials and assignment</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="register-data.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Register Data On-Chain</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>

  <style>
    .cc {
      position: relative;
      bottom: 0%;
      left: 0%;
    }

    .cc a {
      display: inline-block;
      text-align: left;
      padding: 16px;
      color: black;
      font-size: 8px;
    }
</style>

<div class="cc">
  <a href="http://creativecommons.org/licenses/by-sa/4.0/">
    <img src="../_static/cc-sa-by.png" />  Copyright 2021 - 2023, Concordium Software ApS
  </a>
</div>
  <div id="cookie-consent" class="consent">
    <p>This website only aggregates and analyzes the actions you take here if you allow cookies. If you do not allow cookies, it protects your privacy, but also prevents the owner from learning from your actions and creating a better experience for you and other users.</p><p>Note that if you opt in and you clear your cookies, delete the opt-in cookie, or if you change computers or Web browsers, you will need to perform the opt-in procedure again.</p>
    <button onclick="consentGranted()">Allow</button>
    <button onclick="consentDenied()">Decline</button>
    <a href="https://concordium.com/privacy-policy/">Privacy policy</a>
</div>

<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];

// Save the choice in a cookie
function storeChoice(granted) {
  document.cookie = "cookie-consent=" + granted
}

// Look for a cookie storing the previous choice of the user.
// Returns undefined if no choice was stored, otherwise a boolean for whether the
// user gave consent.
function loadChoice() {
  if (!document.cookie.includes("cookie-consent=")) {
      return undefined;
  }
  return document.cookie.includes("cookie-consent=true")
}

// Removes the cookie consent banner
function removeCookieConsentBanner() {
  document.getElementById("cookie-consent").remove()
}

// Called by the cookie consent banner if granted permission
function consentGranted() {
  storeChoice(true)
  _paq.push(['setCookieConsentGiven']);
  removeCookieConsentBanner()
}

// Called by the cookie consent banner if denied permission
function consentDenied() {
  storeChoice(true)
  removeCookieConsentBanner()
}

const stored = loadChoice();
if (stored) {
 consentGranted()
}

_paq.push(['requireCookieConsent']);
/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);

(function() {
    var u="https://concordium.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/concordium.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();

  // remember tracking consent was given for all subsequent page views and visits
_paq.push(['rememberCookieConsentGiven']);

</script>

  </body>
</html>